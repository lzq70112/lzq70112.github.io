<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>descheduler技术打烊 | xiongmao&#39;s blog</title>
    <meta name="generator" content="VuePress 1.9.5">
    <link rel="icon" href="/img/favicon.ico">
    <meta name="description" content="K8S、ELK、Jenkins、DevOps、CI/CD、Python、go、运维、运维开发、云原生、集群运维">
    <meta name="keywords" content="K8S、ELK、Jenkins、DevOps、CI/CD、Python、nginx、tomcat、mysql、ansible">
    <meta name="baidu-site-verification" content="b9w0xnx4YF">
    <meta name="theme-color" content="#11a8cd">
    
    <link rel="preload" href="/assets/css/0.styles.6732922a.css" as="style"><link rel="preload" href="/assets/js/app.e7221624.js" as="script"><link rel="preload" href="/assets/js/2.1e679d1d.js" as="script"><link rel="preload" href="/assets/js/112.5e0c1c97.js" as="script"><link rel="prefetch" href="/assets/js/10.a711d5fc.js"><link rel="prefetch" href="/assets/js/100.24d6aa43.js"><link rel="prefetch" href="/assets/js/101.c117fc2a.js"><link rel="prefetch" href="/assets/js/102.6b262694.js"><link rel="prefetch" href="/assets/js/103.7bf86548.js"><link rel="prefetch" href="/assets/js/104.54770dc3.js"><link rel="prefetch" href="/assets/js/105.f9af743e.js"><link rel="prefetch" href="/assets/js/106.553f5ef8.js"><link rel="prefetch" href="/assets/js/107.265aceab.js"><link rel="prefetch" href="/assets/js/108.f20abc28.js"><link rel="prefetch" href="/assets/js/109.a27e2a34.js"><link rel="prefetch" href="/assets/js/11.a6dae5da.js"><link rel="prefetch" href="/assets/js/110.c922f6fd.js"><link rel="prefetch" href="/assets/js/111.4fa6852b.js"><link rel="prefetch" href="/assets/js/113.5af907d8.js"><link rel="prefetch" href="/assets/js/114.20f5b2ef.js"><link rel="prefetch" href="/assets/js/115.e9ed1b7d.js"><link rel="prefetch" href="/assets/js/116.87448a71.js"><link rel="prefetch" href="/assets/js/117.664f9e24.js"><link rel="prefetch" href="/assets/js/118.c3ad91dc.js"><link rel="prefetch" href="/assets/js/119.fea33d99.js"><link rel="prefetch" href="/assets/js/12.5e6cb236.js"><link rel="prefetch" href="/assets/js/120.99135414.js"><link rel="prefetch" href="/assets/js/121.67431f42.js"><link rel="prefetch" href="/assets/js/122.e5b201e1.js"><link rel="prefetch" href="/assets/js/123.56a8519c.js"><link rel="prefetch" href="/assets/js/124.f46051c7.js"><link rel="prefetch" href="/assets/js/125.d1426c10.js"><link rel="prefetch" href="/assets/js/126.935ac184.js"><link rel="prefetch" href="/assets/js/127.96e995ee.js"><link rel="prefetch" href="/assets/js/128.25122e8b.js"><link rel="prefetch" href="/assets/js/129.d920ab03.js"><link rel="prefetch" href="/assets/js/13.8fb916dd.js"><link rel="prefetch" href="/assets/js/130.f22667b3.js"><link rel="prefetch" href="/assets/js/131.767ff4bc.js"><link rel="prefetch" href="/assets/js/132.8d98b382.js"><link rel="prefetch" href="/assets/js/133.7d094f05.js"><link rel="prefetch" href="/assets/js/134.b0ceb6e3.js"><link rel="prefetch" href="/assets/js/135.f79e660b.js"><link rel="prefetch" href="/assets/js/136.953d769e.js"><link rel="prefetch" href="/assets/js/137.9d5802d2.js"><link rel="prefetch" href="/assets/js/138.8e02fa5c.js"><link rel="prefetch" href="/assets/js/139.b9e91678.js"><link rel="prefetch" href="/assets/js/14.bc1837be.js"><link rel="prefetch" href="/assets/js/140.4699c687.js"><link rel="prefetch" href="/assets/js/141.8eefbbaa.js"><link rel="prefetch" href="/assets/js/142.27d45adb.js"><link rel="prefetch" href="/assets/js/143.f6f923f7.js"><link rel="prefetch" href="/assets/js/144.f14a5230.js"><link rel="prefetch" href="/assets/js/145.2c25c568.js"><link rel="prefetch" href="/assets/js/146.788e90e0.js"><link rel="prefetch" href="/assets/js/147.b3120ee6.js"><link rel="prefetch" href="/assets/js/148.62b7c62a.js"><link rel="prefetch" href="/assets/js/149.a5c5ace4.js"><link rel="prefetch" href="/assets/js/15.bcde294a.js"><link rel="prefetch" href="/assets/js/150.86d0eb3a.js"><link rel="prefetch" href="/assets/js/151.b653d4ff.js"><link rel="prefetch" href="/assets/js/152.0eeee040.js"><link rel="prefetch" href="/assets/js/153.0b7a1da9.js"><link rel="prefetch" href="/assets/js/154.d80a7f08.js"><link rel="prefetch" href="/assets/js/155.4531d3d6.js"><link rel="prefetch" href="/assets/js/156.2f305049.js"><link rel="prefetch" href="/assets/js/157.d2a0fbc5.js"><link rel="prefetch" href="/assets/js/158.6a87dd62.js"><link rel="prefetch" href="/assets/js/159.ce0968fd.js"><link rel="prefetch" href="/assets/js/16.a96da137.js"><link rel="prefetch" href="/assets/js/160.f7508c8f.js"><link rel="prefetch" href="/assets/js/161.91b40a07.js"><link rel="prefetch" href="/assets/js/162.d066159e.js"><link rel="prefetch" href="/assets/js/163.ded50322.js"><link rel="prefetch" href="/assets/js/164.866bec3d.js"><link rel="prefetch" href="/assets/js/165.79580fd7.js"><link rel="prefetch" href="/assets/js/166.b76915c2.js"><link rel="prefetch" href="/assets/js/167.4122b048.js"><link rel="prefetch" href="/assets/js/168.2ade24d2.js"><link rel="prefetch" href="/assets/js/169.e4cf458b.js"><link rel="prefetch" href="/assets/js/17.329a0167.js"><link rel="prefetch" href="/assets/js/170.055e2f01.js"><link rel="prefetch" href="/assets/js/171.8d1021c2.js"><link rel="prefetch" href="/assets/js/172.979e1d08.js"><link rel="prefetch" href="/assets/js/173.0e5667db.js"><link rel="prefetch" href="/assets/js/174.13df9b11.js"><link rel="prefetch" href="/assets/js/175.b0f8e245.js"><link rel="prefetch" href="/assets/js/176.8011865c.js"><link rel="prefetch" href="/assets/js/177.3c82b4a9.js"><link rel="prefetch" href="/assets/js/178.1427ffad.js"><link rel="prefetch" href="/assets/js/179.9e55fe39.js"><link rel="prefetch" href="/assets/js/18.048038df.js"><link rel="prefetch" href="/assets/js/180.1f316f88.js"><link rel="prefetch" href="/assets/js/181.830e98f1.js"><link rel="prefetch" href="/assets/js/182.807b4423.js"><link rel="prefetch" href="/assets/js/183.56e5d811.js"><link rel="prefetch" href="/assets/js/184.58165fc4.js"><link rel="prefetch" href="/assets/js/185.9eb4fb3e.js"><link rel="prefetch" href="/assets/js/186.801d2024.js"><link rel="prefetch" href="/assets/js/187.0767512b.js"><link rel="prefetch" href="/assets/js/188.860f9aa7.js"><link rel="prefetch" href="/assets/js/189.d849c1c4.js"><link rel="prefetch" href="/assets/js/19.674f919f.js"><link rel="prefetch" href="/assets/js/190.1daa10ee.js"><link rel="prefetch" href="/assets/js/191.467bba3f.js"><link rel="prefetch" href="/assets/js/192.841a56c3.js"><link rel="prefetch" href="/assets/js/193.89bcabec.js"><link rel="prefetch" href="/assets/js/194.e8ded807.js"><link rel="prefetch" href="/assets/js/195.3e7b0617.js"><link rel="prefetch" href="/assets/js/196.95f00ff1.js"><link rel="prefetch" href="/assets/js/197.76d38222.js"><link rel="prefetch" href="/assets/js/198.7e1912e1.js"><link rel="prefetch" href="/assets/js/199.8a7f294d.js"><link rel="prefetch" href="/assets/js/20.56b4d647.js"><link rel="prefetch" href="/assets/js/200.9b1ddc2a.js"><link rel="prefetch" href="/assets/js/201.291b74c8.js"><link rel="prefetch" href="/assets/js/202.15d119a4.js"><link rel="prefetch" href="/assets/js/203.d7d33e0b.js"><link rel="prefetch" href="/assets/js/204.e1ab1070.js"><link rel="prefetch" href="/assets/js/205.c391b268.js"><link rel="prefetch" href="/assets/js/206.bf3b2e92.js"><link rel="prefetch" href="/assets/js/207.754f6593.js"><link rel="prefetch" href="/assets/js/208.6fad6e05.js"><link rel="prefetch" href="/assets/js/209.4afd7509.js"><link rel="prefetch" href="/assets/js/21.60c8872f.js"><link rel="prefetch" href="/assets/js/210.4bd3dbe8.js"><link rel="prefetch" href="/assets/js/211.19a1b42c.js"><link rel="prefetch" href="/assets/js/212.57a1b8c5.js"><link rel="prefetch" href="/assets/js/213.bd4c5274.js"><link rel="prefetch" href="/assets/js/214.8921ec84.js"><link rel="prefetch" href="/assets/js/215.459b1d0e.js"><link rel="prefetch" href="/assets/js/216.aebd6bf1.js"><link rel="prefetch" href="/assets/js/217.dab1470b.js"><link rel="prefetch" href="/assets/js/218.6e059aec.js"><link rel="prefetch" href="/assets/js/219.72054a37.js"><link rel="prefetch" href="/assets/js/22.fdf97007.js"><link rel="prefetch" href="/assets/js/220.7184442c.js"><link rel="prefetch" href="/assets/js/221.afdbe6c1.js"><link rel="prefetch" href="/assets/js/222.eac2b252.js"><link rel="prefetch" href="/assets/js/223.4785e013.js"><link rel="prefetch" href="/assets/js/224.27358d52.js"><link rel="prefetch" href="/assets/js/225.0082a87e.js"><link rel="prefetch" href="/assets/js/226.a6a027b2.js"><link rel="prefetch" href="/assets/js/227.55b58d50.js"><link rel="prefetch" href="/assets/js/228.172efcf6.js"><link rel="prefetch" href="/assets/js/229.d534fb18.js"><link rel="prefetch" href="/assets/js/23.10a156cb.js"><link rel="prefetch" href="/assets/js/230.720d75bc.js"><link rel="prefetch" href="/assets/js/231.7bc7aa8f.js"><link rel="prefetch" href="/assets/js/232.3f9ab0c4.js"><link rel="prefetch" href="/assets/js/233.d74308ce.js"><link rel="prefetch" href="/assets/js/234.dd9ae057.js"><link rel="prefetch" href="/assets/js/235.ec785b6e.js"><link rel="prefetch" href="/assets/js/236.267e73c5.js"><link rel="prefetch" href="/assets/js/237.2e57b470.js"><link rel="prefetch" href="/assets/js/238.3f9da24a.js"><link rel="prefetch" href="/assets/js/239.e03ebe19.js"><link rel="prefetch" href="/assets/js/24.4e04c9e7.js"><link rel="prefetch" href="/assets/js/240.0d490de0.js"><link rel="prefetch" href="/assets/js/241.7505bfb6.js"><link rel="prefetch" href="/assets/js/242.137a5428.js"><link rel="prefetch" href="/assets/js/243.b8914177.js"><link rel="prefetch" href="/assets/js/244.da9e248f.js"><link rel="prefetch" href="/assets/js/245.28437df7.js"><link rel="prefetch" href="/assets/js/246.2c235016.js"><link rel="prefetch" href="/assets/js/247.52676c46.js"><link rel="prefetch" href="/assets/js/248.ece61318.js"><link rel="prefetch" href="/assets/js/249.ff7eccd2.js"><link rel="prefetch" href="/assets/js/25.e17374f9.js"><link rel="prefetch" href="/assets/js/250.dac20dcd.js"><link rel="prefetch" href="/assets/js/251.bc176c68.js"><link rel="prefetch" href="/assets/js/252.279835bc.js"><link rel="prefetch" href="/assets/js/253.7497ddda.js"><link rel="prefetch" href="/assets/js/254.95475930.js"><link rel="prefetch" href="/assets/js/255.02dc3505.js"><link rel="prefetch" href="/assets/js/256.a34c36ad.js"><link rel="prefetch" href="/assets/js/257.67ad6470.js"><link rel="prefetch" href="/assets/js/258.ea2b27b5.js"><link rel="prefetch" href="/assets/js/259.81209387.js"><link rel="prefetch" href="/assets/js/26.34503cad.js"><link rel="prefetch" href="/assets/js/260.024c3f3e.js"><link rel="prefetch" href="/assets/js/261.0df7357d.js"><link rel="prefetch" href="/assets/js/262.4e6da19e.js"><link rel="prefetch" href="/assets/js/263.28548e49.js"><link rel="prefetch" href="/assets/js/264.a711087c.js"><link rel="prefetch" href="/assets/js/265.45b7c9b8.js"><link rel="prefetch" href="/assets/js/266.65ee3594.js"><link rel="prefetch" href="/assets/js/267.4eeefd02.js"><link rel="prefetch" href="/assets/js/268.eb8fffe3.js"><link rel="prefetch" href="/assets/js/269.aa6a90b0.js"><link rel="prefetch" href="/assets/js/27.bd1f04ea.js"><link rel="prefetch" href="/assets/js/270.162a9089.js"><link rel="prefetch" href="/assets/js/271.fc29d223.js"><link rel="prefetch" href="/assets/js/272.0dda0be6.js"><link rel="prefetch" href="/assets/js/273.afc6b167.js"><link rel="prefetch" href="/assets/js/274.e7c546a6.js"><link rel="prefetch" href="/assets/js/275.b978f78e.js"><link rel="prefetch" href="/assets/js/276.43860563.js"><link rel="prefetch" href="/assets/js/277.f2150475.js"><link rel="prefetch" href="/assets/js/278.0941595a.js"><link rel="prefetch" href="/assets/js/279.d943f446.js"><link rel="prefetch" href="/assets/js/28.a709d8a8.js"><link rel="prefetch" href="/assets/js/280.ec13f58e.js"><link rel="prefetch" href="/assets/js/281.4266e436.js"><link rel="prefetch" href="/assets/js/282.56735a7a.js"><link rel="prefetch" href="/assets/js/283.70d7ad21.js"><link rel="prefetch" href="/assets/js/284.3dccddfa.js"><link rel="prefetch" href="/assets/js/285.62b34a26.js"><link rel="prefetch" href="/assets/js/286.cd4c9adf.js"><link rel="prefetch" href="/assets/js/287.e110a68f.js"><link rel="prefetch" href="/assets/js/288.68978e3e.js"><link rel="prefetch" href="/assets/js/289.9f5dcd49.js"><link rel="prefetch" href="/assets/js/29.e2e496dd.js"><link rel="prefetch" href="/assets/js/290.b86da697.js"><link rel="prefetch" href="/assets/js/291.a564a706.js"><link rel="prefetch" href="/assets/js/292.20a8d093.js"><link rel="prefetch" href="/assets/js/293.8f13aa53.js"><link rel="prefetch" href="/assets/js/294.c08ff719.js"><link rel="prefetch" href="/assets/js/295.68af44f0.js"><link rel="prefetch" href="/assets/js/296.62ac2911.js"><link rel="prefetch" href="/assets/js/297.ca51a0df.js"><link rel="prefetch" href="/assets/js/298.fe843a9c.js"><link rel="prefetch" href="/assets/js/299.93f52b75.js"><link rel="prefetch" href="/assets/js/3.256457cb.js"><link rel="prefetch" href="/assets/js/30.55c1d01b.js"><link rel="prefetch" href="/assets/js/300.316522e5.js"><link rel="prefetch" href="/assets/js/301.f99ac528.js"><link rel="prefetch" href="/assets/js/302.b37fa14b.js"><link rel="prefetch" href="/assets/js/303.b7af66cf.js"><link rel="prefetch" href="/assets/js/304.238e8c3b.js"><link rel="prefetch" href="/assets/js/305.3a59f2d0.js"><link rel="prefetch" href="/assets/js/306.03be0708.js"><link rel="prefetch" href="/assets/js/307.45284eb1.js"><link rel="prefetch" href="/assets/js/308.e96d9ca0.js"><link rel="prefetch" href="/assets/js/309.33e5c121.js"><link rel="prefetch" href="/assets/js/31.1f0c8edd.js"><link rel="prefetch" href="/assets/js/32.9e99cdeb.js"><link rel="prefetch" href="/assets/js/33.48c69098.js"><link rel="prefetch" href="/assets/js/34.a6843d71.js"><link rel="prefetch" href="/assets/js/35.7688e566.js"><link rel="prefetch" href="/assets/js/36.ac72cc70.js"><link rel="prefetch" href="/assets/js/37.1e25ed4a.js"><link rel="prefetch" href="/assets/js/38.a3765157.js"><link rel="prefetch" href="/assets/js/39.962392a9.js"><link rel="prefetch" href="/assets/js/4.8e736c7d.js"><link rel="prefetch" href="/assets/js/40.bc83f81b.js"><link rel="prefetch" href="/assets/js/41.1951766e.js"><link rel="prefetch" href="/assets/js/42.39113478.js"><link rel="prefetch" href="/assets/js/43.37c5c2be.js"><link rel="prefetch" href="/assets/js/44.d2b1f9dd.js"><link rel="prefetch" href="/assets/js/45.720c7121.js"><link rel="prefetch" href="/assets/js/46.30d1fc2a.js"><link rel="prefetch" href="/assets/js/47.3e6a5e18.js"><link rel="prefetch" href="/assets/js/48.2cb1bcdf.js"><link rel="prefetch" href="/assets/js/49.dc40f4fe.js"><link rel="prefetch" href="/assets/js/5.bedf66e3.js"><link rel="prefetch" href="/assets/js/50.004e7368.js"><link rel="prefetch" href="/assets/js/51.96480463.js"><link rel="prefetch" href="/assets/js/52.8171064f.js"><link rel="prefetch" href="/assets/js/53.aeabf1b7.js"><link rel="prefetch" href="/assets/js/54.a69a5494.js"><link rel="prefetch" href="/assets/js/55.4e3362b8.js"><link rel="prefetch" href="/assets/js/56.cf00203d.js"><link rel="prefetch" href="/assets/js/57.7dad9f05.js"><link rel="prefetch" href="/assets/js/58.5a599aa3.js"><link rel="prefetch" href="/assets/js/59.7a41d4ec.js"><link rel="prefetch" href="/assets/js/6.aa30f1b7.js"><link rel="prefetch" href="/assets/js/60.743bc681.js"><link rel="prefetch" href="/assets/js/61.30370304.js"><link rel="prefetch" href="/assets/js/62.1880bf44.js"><link rel="prefetch" href="/assets/js/63.625ede55.js"><link rel="prefetch" href="/assets/js/64.a0e699b3.js"><link rel="prefetch" href="/assets/js/65.1332e799.js"><link rel="prefetch" href="/assets/js/66.bf13ff4e.js"><link rel="prefetch" href="/assets/js/67.b1f02878.js"><link rel="prefetch" href="/assets/js/68.d9e97dc1.js"><link rel="prefetch" href="/assets/js/69.5fc5d0ad.js"><link rel="prefetch" href="/assets/js/7.b3b653a5.js"><link rel="prefetch" href="/assets/js/70.f0695449.js"><link rel="prefetch" href="/assets/js/71.f3df3763.js"><link rel="prefetch" href="/assets/js/72.ab0393fe.js"><link rel="prefetch" href="/assets/js/73.dc1ad4a0.js"><link rel="prefetch" href="/assets/js/74.98ea0207.js"><link rel="prefetch" href="/assets/js/75.75a79389.js"><link rel="prefetch" href="/assets/js/76.7b07f2b0.js"><link rel="prefetch" href="/assets/js/77.517e9335.js"><link rel="prefetch" href="/assets/js/78.90d5b20d.js"><link rel="prefetch" href="/assets/js/79.a2fdc1e8.js"><link rel="prefetch" href="/assets/js/8.e41b72a1.js"><link rel="prefetch" href="/assets/js/80.ce3db513.js"><link rel="prefetch" href="/assets/js/81.e9f26768.js"><link rel="prefetch" href="/assets/js/82.6ae00170.js"><link rel="prefetch" href="/assets/js/83.0a300de3.js"><link rel="prefetch" href="/assets/js/84.7f61b37c.js"><link rel="prefetch" href="/assets/js/85.52c4f70c.js"><link rel="prefetch" href="/assets/js/86.bb2b54e2.js"><link rel="prefetch" href="/assets/js/87.9632dc47.js"><link rel="prefetch" href="/assets/js/88.5736b64f.js"><link rel="prefetch" href="/assets/js/89.113520f8.js"><link rel="prefetch" href="/assets/js/9.72f4cc05.js"><link rel="prefetch" href="/assets/js/90.809eed5c.js"><link rel="prefetch" href="/assets/js/91.db653d35.js"><link rel="prefetch" href="/assets/js/92.f1c7d0c5.js"><link rel="prefetch" href="/assets/js/93.fabbd55d.js"><link rel="prefetch" href="/assets/js/94.951a8287.js"><link rel="prefetch" href="/assets/js/95.6b89432f.js"><link rel="prefetch" href="/assets/js/96.ab0e2ef7.js"><link rel="prefetch" href="/assets/js/97.bb53d2e5.js"><link rel="prefetch" href="/assets/js/98.16ee1d21.js"><link rel="prefetch" href="/assets/js/99.9b4ae87d.js">
    <link rel="stylesheet" href="/assets/css/0.styles.6732922a.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu have-body-img"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/EB-logo.png" alt="xiongmao's blog" class="logo"> <span class="site-name can-hide">xiongmao's blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="运维" class="dropdown-title"><a href="/Operation/" class="link-title">运维</a> <span class="title" style="display:none;">运维</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>linux运维</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/note/nginx/" class="nav-link">nginx</a></li><li class="dropdown-subitem"><a href="/note/docker/" class="nav-link">docker</a></li><li class="dropdown-subitem"><a href="/note/elk/" class="nav-link">elk</a></li><li class="dropdown-subitem"><a href="/note/jenkins/" class="nav-link">jenkins</a></li><li class="dropdown-subitem"><a href="/note/jumpserver/" class="nav-link">jumpserver</a></li><li class="dropdown-subitem"><a href="/note/K8S/" class="nav-link">K8S</a></li><li class="dropdown-subitem"><a href="/note/linux/" class="nav-link">linux系统</a></li><li class="dropdown-subitem"><a href="/note/mysql/" class="nav-link">mysql</a></li><li class="dropdown-subitem"><a href="/note/ceph/" class="nav-link">ceph</a></li><li class="dropdown-subitem"><a href="/note/Prometheus/" class="nav-link">Prometheus</a></li><li class="dropdown-subitem"><a href="/note/redis/" class="nav-link">redis</a></li><li class="dropdown-subitem"><a href="/note/tomcat/" class="nav-link">tomcat</a></li><li class="dropdown-subitem"><a href="/note/zabbix/" class="nav-link">zabbix</a></li><li class="dropdown-subitem"><a href="/note/zookeeper/" class="nav-link">zookeeper</a></li><li class="dropdown-subitem"><a href="/note/KVM/" class="nav-link">KVM</a></li><li class="dropdown-subitem"><a href="/note/ansible/" class="nav-link">ansible</a></li></ul></li><li class="dropdown-item"><h4>网络运维</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/note/网络知识/" class="nav-link">网络知识</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="开发" class="dropdown-title"><a href="/Develop/" class="link-title">开发</a> <span class="title" style="display:none;">开发</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/note/python/" class="nav-link">python</a></li><li class="dropdown-item"><!----> <a href="/note/shell/" class="nav-link">shell</a></li><li class="dropdown-item"><!----> <a href="/note/go/" class="nav-link">go</a></li></ul></div></div><div class="nav-item"><a href="/more/" class="nav-link">踩坑</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="技术" class="dropdown-title"><a href="/technology/" class="link-title">技术</a> <span class="title" style="display:none;">技术</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/9a7ee40fc232253e/" class="nav-link">技术文档</a></li><li class="dropdown-item"><!----> <a href="/pages/4c778760be26d8b3/" class="nav-link">GitHub技巧</a></li><li class="dropdown-item"><!----> <a href="/pages/117708e0af7f0bd9/" class="nav-link">Nodejs</a></li><li class="dropdown-item"><!----> <a href="/pages/41f87d890d0a02af/" class="nav-link">博客搭建</a></li><li class="dropdown-item"><!----> <a href="/pages/beb6c0bd8a66cea6/" class="nav-link">网站</a></li><li class="dropdown-item"><!----> <a href="/pages/beb6c0bd8a66cea61/" class="nav-link">葵花宝典</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">归档</a></li></ul></div></div><div class="nav-item"><a href="/friends/" class="nav-link">友情链接</a></div><div class="nav-item"><a href="/about/" class="nav-link">关于</a></div> <a href="https://github.com/lzq70112/lzq70112.github.io" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="/img/20200615022410.png"> <div class="blogger-info"><h3>胸毛君</h3> <span>运维界的小学生</span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="运维" class="dropdown-title"><a href="/Operation/" class="link-title">运维</a> <span class="title" style="display:none;">运维</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>linux运维</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/note/nginx/" class="nav-link">nginx</a></li><li class="dropdown-subitem"><a href="/note/docker/" class="nav-link">docker</a></li><li class="dropdown-subitem"><a href="/note/elk/" class="nav-link">elk</a></li><li class="dropdown-subitem"><a href="/note/jenkins/" class="nav-link">jenkins</a></li><li class="dropdown-subitem"><a href="/note/jumpserver/" class="nav-link">jumpserver</a></li><li class="dropdown-subitem"><a href="/note/K8S/" class="nav-link">K8S</a></li><li class="dropdown-subitem"><a href="/note/linux/" class="nav-link">linux系统</a></li><li class="dropdown-subitem"><a href="/note/mysql/" class="nav-link">mysql</a></li><li class="dropdown-subitem"><a href="/note/ceph/" class="nav-link">ceph</a></li><li class="dropdown-subitem"><a href="/note/Prometheus/" class="nav-link">Prometheus</a></li><li class="dropdown-subitem"><a href="/note/redis/" class="nav-link">redis</a></li><li class="dropdown-subitem"><a href="/note/tomcat/" class="nav-link">tomcat</a></li><li class="dropdown-subitem"><a href="/note/zabbix/" class="nav-link">zabbix</a></li><li class="dropdown-subitem"><a href="/note/zookeeper/" class="nav-link">zookeeper</a></li><li class="dropdown-subitem"><a href="/note/KVM/" class="nav-link">KVM</a></li><li class="dropdown-subitem"><a href="/note/ansible/" class="nav-link">ansible</a></li></ul></li><li class="dropdown-item"><h4>网络运维</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/note/网络知识/" class="nav-link">网络知识</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="开发" class="dropdown-title"><a href="/Develop/" class="link-title">开发</a> <span class="title" style="display:none;">开发</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/note/python/" class="nav-link">python</a></li><li class="dropdown-item"><!----> <a href="/note/shell/" class="nav-link">shell</a></li><li class="dropdown-item"><!----> <a href="/note/go/" class="nav-link">go</a></li></ul></div></div><div class="nav-item"><a href="/more/" class="nav-link">踩坑</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="技术" class="dropdown-title"><a href="/technology/" class="link-title">技术</a> <span class="title" style="display:none;">技术</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/9a7ee40fc232253e/" class="nav-link">技术文档</a></li><li class="dropdown-item"><!----> <a href="/pages/4c778760be26d8b3/" class="nav-link">GitHub技巧</a></li><li class="dropdown-item"><!----> <a href="/pages/117708e0af7f0bd9/" class="nav-link">Nodejs</a></li><li class="dropdown-item"><!----> <a href="/pages/41f87d890d0a02af/" class="nav-link">博客搭建</a></li><li class="dropdown-item"><!----> <a href="/pages/beb6c0bd8a66cea6/" class="nav-link">网站</a></li><li class="dropdown-item"><!----> <a href="/pages/beb6c0bd8a66cea61/" class="nav-link">葵花宝典</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">归档</a></li></ul></div></div><div class="nav-item"><a href="/friends/" class="nav-link">友情链接</a></div><div class="nav-item"><a href="/about/" class="nav-link">关于</a></div> <a href="https://github.com/lzq70112/lzq70112.github.io" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><a href="/pages/b5e1457/" class="sidebar-link">K8S-service的全名称构成</a></li><li><a href="/pages/b5e1543/" class="sidebar-link">kubeasz部署K8S</a></li><li><a href="/pages/b5e1544/" class="sidebar-link">kubeasz3部署K8S-dashboard篇</a></li><li><a href="/pages/b5e1545/" class="sidebar-link">kubeasz3部署K8S-dns篇</a></li><li><a href="/pages/b5e1546/" class="sidebar-link">kubeasz3部署K8S-master篇</a></li><li><a href="/pages/b5e1547/" class="sidebar-link">kubeasz3部署K8S-node篇</a></li><li><a href="/pages/b5e1549/" class="sidebar-link">kubeasz3部署etcd篇</a></li><li><a href="/pages/b5e1551/" class="sidebar-link">kubeasz3部署fannel篇</a></li><li><a href="/pages/b5e1552/" class="sidebar-link">kubeasz3部署K8S-calico篇</a></li><li><a href="/pages/b5e1553/" class="sidebar-link">K8S分层构建nginx+tomcat+NFS存储卷做动静分离访问</a></li><li><a href="/pages/b5e1554/" class="sidebar-link">K8S之HPA自动伸缩应用</a></li><li><a href="/pages/b5e1555/" class="sidebar-link">K8S标签、回滚及ectd删除资源</a></li><li><a href="/pages/b5e1556/" class="sidebar-link">K8S-PV及PVC案例-zookeeper</a></li><li><a href="/pages/b5e1557/" class="sidebar-link">K8S-PV及PVC案例-jenkins</a></li><li><a href="/pages/b5e1559/" class="sidebar-link">K8S-PV及PVC案例-redis</a></li><li><a href="/pages/b5e1560/" class="sidebar-link">K8S-PV及PVC案例-mysql主从</a></li><li><a href="/pages/b5e15615/" class="sidebar-link">K8S-PV及PVC案例-单POD部署NGINX+PHP，调用mysql</a></li><li><a href="/pages/b5e156121/" class="sidebar-link">K8S-gitlab+jenkins 自由风格部署和回滚</a></li><li><a href="/pages/b5e156122/" class="sidebar-link">K8S之helm安装及使用</a></li><li><a href="/pages/b5e156123/" class="sidebar-link">K8S之Traefix2</a></li><li><a href="/pages/b5e156128/" class="sidebar-link">K8S之job</a></li><li><a href="/pages/b5e15610122/" class="sidebar-link">coredns添加hosts无法解析</a></li><li><a href="/pages/b5e1561012/" class="sidebar-link">yaml中配置文件的换行符</a></li><li><a href="/pages/b5e156101/" class="sidebar-link">K8S概念什么是CRD</a></li><li><a href="/pages/b5e156100/" class="sidebar-link">K8S概念什么是Gateway API</a></li><li><a href="/pages/b5e15699/" class="sidebar-link">K8S概念亲和度、容忍度</a></li><li><a href="/pages/b15e15699/" class="sidebar-link">K8S的端口转发</a></li><li><a href="/pages/K8S102/" aria-current="page" class="active sidebar-link">descheduler技术打烊</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/K8S102/#_1、descheduler背景" class="sidebar-link">1、descheduler背景</a></li><li class="sidebar-sub-header"><a href="/pages/K8S102/#_2、descheduler驱逐策略" class="sidebar-link">2、descheduler驱逐策略</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/K8S102/#_2-1、removeduplicates" class="sidebar-link">2.1、RemoveDuplicates</a></li><li class="sidebar-sub-header"><a href="/pages/K8S102/#_2-2、lownodeutilization" class="sidebar-link">2.2、LowNodeUtilization</a></li><li class="sidebar-sub-header"><a href="/pages/K8S102/#_2-3、highnodeutilization" class="sidebar-link">2.3、HighNodeUtilization</a></li><li class="sidebar-sub-header"><a href="/pages/K8S102/#_2-4、removepodsviolatinginterpodantiaffinity" class="sidebar-link">2.4、RemovePodsViolatingInterPodAntiAffinity</a></li><li class="sidebar-sub-header"><a href="/pages/K8S102/#_2-5、removepodsviolatingnodeaffinity" class="sidebar-link">2.5、RemovePodsViolatingNodeAffinity</a></li><li class="sidebar-sub-header"><a href="/pages/K8S102/#_2-6、removepodsviolatingnodetaints" class="sidebar-link">2.6、RemovePodsViolatingNodeTaints</a></li><li class="sidebar-sub-header"><a href="/pages/K8S102/#_2-7、removepodsviolatingtopologyspreadconstraint" class="sidebar-link">2.7、RemovePodsViolatingTopologySpreadConstraint</a></li><li class="sidebar-sub-header"><a href="/pages/K8S102/#_2-8、removepodshavingtoomanyrestarts" class="sidebar-link">2.8、RemovePodsHavingTooManyRestarts</a></li><li class="sidebar-sub-header"><a href="/pages/K8S102/#_2-9、podlifetime" class="sidebar-link">2.9、PodLifeTime</a></li><li class="sidebar-sub-header"><a href="/pages/K8S102/#_2-10、removefailedpods" class="sidebar-link">2.10、RemoveFailedPods</a></li></ul></li><li class="sidebar-sub-header"><a href="/pages/K8S102/#_3、针对资源过滤" class="sidebar-link">3、针对资源过滤</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/K8S102/#_3-1、namespace过滤" class="sidebar-link">3.1、Namespace过滤</a></li><li class="sidebar-sub-header"><a href="/pages/K8S102/#_3-2、priority过滤" class="sidebar-link">3.2、Priority过滤</a></li><li class="sidebar-sub-header"><a href="/pages/K8S102/#_3-3、label-过滤" class="sidebar-link">3.3、Label 过滤</a></li><li class="sidebar-sub-header"><a href="/pages/K8S102/#_3-4、node-fit-过滤" class="sidebar-link">3.4、node Fit 过滤</a></li></ul></li><li class="sidebar-sub-header"><a href="/pages/K8S102/#_4、pod驱逐的原则" class="sidebar-link">4、pod驱逐的原则</a></li><li class="sidebar-sub-header"><a href="/pages/K8S102/#_5、安装" class="sidebar-link">5、安装</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/K8S102/#_5-1、安装metrics-server" class="sidebar-link">5.1、安装metrics-server</a></li><li class="sidebar-sub-header"><a href="/pages/K8S102/#_5-2、安装descheduler" class="sidebar-link">5.2、安装descheduler</a></li></ul></li><li class="sidebar-sub-header"><a href="/pages/K8S102/#_6、测试驱逐" class="sidebar-link">6、测试驱逐</a></li></ul></li><li><a href="/pages/K8S103/" class="sidebar-link">K8S全量备份迁移还原</a></li><li><a href="/pages/K8S104/" class="sidebar-link">K8S暴露端口的5种方法</a></li><li><a href="/pages/k8s105/" class="sidebar-link">K8S针对于pod、容器权限及控制</a></li><li><a href="/pages/k8s106/" class="sidebar-link">手动指定k8s云存储地址创建nfs PV PVC</a></li><li><a href="/pages/k8s107/" class="sidebar-link">k8s对gpu节点应用</a></li><li><a href="/pages/k8s108/" class="sidebar-link">k8s处理json的两种方式</a></li><li><a href="/pages/k8s109/" class="sidebar-link">awk的高级应用处理ingress导致的路由冲突</a></li><li><a href="/pages/k8s110/" class="sidebar-link">kubelet硬件资源驱逐策略</a></li><li><a href="/pages/k8s111/" class="sidebar-link">k8s云存储nfs的nolock详解</a></li><li><a href="/pages/k8s112/" class="sidebar-link">k8sCPU独占</a></li><li><a href="/pages/k8s113/" class="sidebar-link">K8S的网络策略</a></li><li><a href="/pages/k8s114/" class="sidebar-link">K8S对临时存储的限制</a></li><li><a href="/pages/k8s115/" class="sidebar-link">calico因为iptables模式错误不断重启的问题</a></li><li><a href="/pages/47c107/" class="sidebar-link">coredns IPV6的解析失败</a></li><li><a href="/pages/k8s117/" class="sidebar-link">containerDataToContainerInfo unable to find data in memory cache导致主机负载高</a></li><li><a href="/pages/k8s118/" class="sidebar-link">Kubectl debug 调试容器</a></li><li><a href="/pages/k8s119/" class="sidebar-link">K8S针对pod抓包</a></li><li><a href="/pages/k8s120/" class="sidebar-link">K8S的coredns的高可用模式</a></li><li><a href="/pages/k8s121/" class="sidebar-link">etcd备份还原及状态查看</a></li><li><a href="/pages/k8s122/" class="sidebar-link">Etcd的compact 机制</a></li><li><a href="/pages/k8s123/" class="sidebar-link">K8S无头服务的内外部访问方式</a></li><li><a href="/pages/k8s124/" class="sidebar-link">namespaces删除一直处于Terminating状态</a></li><li><a href="/pages/k8s125/" class="sidebar-link">K8S的POD安全</a></li><li><a href="/pages/k8s126/" class="sidebar-link">ingress常用基础知识</a></li><li><a href="/pages/k8s127/" class="sidebar-link">K8S DS控制器优化重启pod重启数量</a></li><li><a href="/pages/k8s128/" class="sidebar-link">K8S的安全平台 NeuVector</a></li><li><a href="/pages/k8s129/" class="sidebar-link">集群最大程度的恢复工作</a></li><li><a href="/pages/k8s130/" class="sidebar-link">K8S的核心组件的运维最佳实践</a></li><li><a href="/pages/k8s131/" class="sidebar-link">harborGC导致状态为只读问题解决</a></li><li><a href="/pages/k8s132/" class="sidebar-link">K8S之localpv的服务文件迁移校验</a></li><li><a href="/pages/k8s133/" class="sidebar-link">为k8s集群的节点预留计算资源</a></li><li><a href="/pages/k8s134/" class="sidebar-link">rancher安装K8S集群实践</a></li><li><a href="/pages/k8s135/" class="sidebar-link">kubeadm安装K8S集群实践</a></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-0c557b5e><div class="articleInfo" data-v-0c557b5e><ul class="breadcrumbs" data-v-0c557b5e><li data-v-0c557b5e><a href="/" title="首页" class="iconfont icon-home router-link-active" data-v-0c557b5e></a></li> <li data-v-0c557b5e><a href="/categories/?category=%E3%80%8AK8S%E3%80%8B%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0" title="分类" data-v-0c557b5e>《K8S》学习笔记</a></li></ul> <div class="info" data-v-0c557b5e><div title="作者" class="author iconfont icon-touxiang" data-v-0c557b5e><a href="https://github.com/lzq7012" target="_blank" title="作者" class="beLink" data-v-0c557b5e>xiongmao</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-0c557b5e><a href="javascript:;" data-v-0c557b5e>2021-09-18</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABH1JREFUSA3tVl1oHFUUPmdmd2ltklqbpJDiNnXFmgbFktho7YMPNiJSSZM0+CAYSkUELVhM6YuwIPpgoOKDqOBDC0XE2CQoNtQXBUFTTcCi+Wlh1V2TQExsUzcltd3M9Tt3ZjZzZ2fT+OJTL8yeM+eee757fmeJbq//KQL8X3DUSFOcfr7cRsRtxNQMWueeVzOkaITIGqQHNg5y8+jNW9ldM7A6nTpAjuolUikAwq7CE3WcM2RRDz+XGVgN3FptU/aUSlvq9Pa3iZ1+sgAqJyyAFqkipd9dqiwHF3P65YycLWc/6sqGrvoEoIp6DOFaX5h6+dnfjkWprwqsPk0dUGq5vySwDImC10KxFHgGL1SWoc92O3eVht09qdXNH11I2SsTsJYqMWzihqGMi+A+Garf3BAuuLI5oGlULyNfyB/HYNujwktOfRrMr5t77NmevqaUopx0grnKAyvVpmwUDB4x6FPXuGvYLTDwWsejwgtgkYKPqRJg8SV6xaiZ3ZTppGneS4yfH5/66fZSDHv+QZci/+h5c5UHtpy67JUqGppM0sh0Nc1dW6/N1W5Yoqat8/TU/VnadmdeW2PLLSyh0cvxBs3KbqTmwYPpxN4do/mzE8nEpvX/UMu2Wbp74zUAK5q6WkHns7V0eWkdPbPzd3rxkTGybadYySumVzhcaJFbs5UrEkQ/+CK8gF5dnh/6ciIZ73gwQ927L1IitoxKLXYP3SjYdOrHHfTZhRRlFyrorafPk20B3HPD1y2G3qKZME5Jcf3t/HUC13/8tSd++vqFveMUTwAUxSUFI1QekR1+bIze3D9MF2aq6cPvG72CgnldWCFqyRw3lwH8ZMerjTD9ElRO7Gv44wNpC90aASqGfVlz/Rx17srQ57/UU26hkhQqUB7dBR71WmzQhHUnblGmVOEw0jhbV1n9OlXUDCIRGaNV5Jp43N516fN7JmnTHdfp7Hgy0luO4aMhtkLL8Bi3bUWYvzh5Mn1dTxrL6QmGuRhGL/TiTTxRoEdTszSaq9GR0NGA3KdkOz3hqSV3MIDhQ5IVX/Ivx3umBti2es2h4eZby7x8br1rkf7Mo90AqC8aQ3sJeNzqFRu+vSANAQe3PL7l0HGOAdwDCeZYvNKeoZp1Qfs6Aipndh86HmFRi0LAnEO47wsqM6cdfjh3jBPUzhZy7nvlUfFsamED1VQt6aISHVymXZ/B2aCtIG8AI8xfobj2d3en1wWVhOeHELKmLQ1s211s88comkv4UCwWyF787mJdYXtNfhKAXVqnKTq8QZvGAGGOfaTo5pGZ/PwbUCr5+DPr/1J92JNHr9aOl/F3iI5+O1nfybsGxoimvZ3ViWSluDITw3P37mypheDIPY0tw7+O/5ApbkYw+zpfaUVu32Pi98+defdUhEpZkRFq0aqyNh9FuL9hpYbEm6iwi0z2REd09ZmyENEbuhjDWzKvZXTqKYaBIr3tt5kuPtQBZFvEUwHt60vfCNu41XsksH9Ij1BMMz1Y0OOunHNShFIP5868g5zeXmuLwL9T4b6Q2+KejgAAAABJRU5ErkJggg==">descheduler技术打烊<!----></h1> <!----> <div class="theme-vdoing-content content__default"><h2 id="_1、descheduler背景"><a href="#_1、descheduler背景" class="header-anchor">#</a> 1、descheduler背景</h2> <p>Kubernetes 中的调度是挂起的 Pod 将绑定到节点的过程，由 Kubernetes 的一个组件执行，称为 kube-scheduler。调度程序的决定，无论 Pod 是否可以或不能调度，都由其可配置的策略指导，该策略由一系列规则组成，称为所谓的词和优先级。调度程序的决策受在出现新的 pod 进行调度时对其 Kubernetes 集群的视图的影响。由于 Kubernetes 实时动态，并且它们的状态会随同着时间而变化，出于各种原因，可能希望已经运行的pod移动到其他一些节点：</p> <ul><li>有一些节点使用不足或使用。</li> <li>最初的调度不再适用，因为在节点上添加或删除了污点或标签，不再满足 pod/节点亲和性要求。</li> <li>一些节点出现故障，它们的pod移动到其他节点。</li> <li>新节点被添加到集群中。</li></ul> <p>因此，可能在集群中不太需要节点上安排了多个 pod。调度器根据其策略寻找可以移动的 Pod 调用其回调。请注意，在当前的实现中，调度器不会安排被调用的 pod 的替换，依赖于默认的调度程序。</p> <h2 id="_2、descheduler驱逐策略"><a href="#_2、descheduler驱逐策略" class="header-anchor">#</a> 2、descheduler驱逐策略</h2> <p>该策略包括适用于所有策略的通用配置</p> <table><thead><tr><th>name</th> <th>默认值</th> <th>描述</th></tr></thead> <tbody><tr><td><code>nodeSelector</code></td> <td><code>nil</code></td> <td>限制处理的节点</td></tr> <tr><td><code>evictLocalStoragePods</code></td> <td><code>false</code></td> <td>允许内有本地存储的豆荚</td></tr> <tr><td><code>evictSystemCriticalPods</code></td> <td><code>false</code></td> <td>[警告：将盗用 Kubernetes 系统 Pod] 允许带有任何优先级的 Pod，包括像 kube-dns 这样的系统 Pod</td></tr> <tr><td><code>ignorePvcPods</code></td> <td><code>false</code></td> <td>PVC pod 设置是否应取消或忽略</td></tr> <tr><td><code>maxNoOfPodsToEvictPerNode</code></td> <td><code>nil</code></td> <td>从每个生命周期引发的最大 Pod 数（通过所有策略求和）</td></tr></tbody></table> <h3 id="_2-1、removeduplicates"><a href="#_2-1、removeduplicates" class="header-anchor">#</a> 2.1、RemoveDuplicates</h3> <p>此策略确保关联ReplicaSet（RS）、ReplicationController（RC）、StatefulSet或job的pod，只有一个pod与在同一节点上运行，如果他们是重复的在同一节点则会被驱逐。</p> <p>例如：如果节点down了，这些节点上的pod被移动到其他节点，导致多个pod与RS或RC关联（例如，在同一节点上运行），则可能会发生此问题。</p> <p>一旦故障节点再次准备就绪，就可以启用此策略来逐出那些重复的pod。</p> <p>它提供了一个可选参数<code>ExcludeOwnerTypes</code>，它是OwnerRef种类的列表。如果某个pod将这些类型中的任何一种列为OwnerRef，则该pod将不会被视为驱逐。</p> <blockquote><p>注意，Deployments创建的POD被认为是此策略的逐出对象。excludeOwnerKinds参数应包括ReplicaSet，排除Deployments创建的POD。</p></blockquote> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> <span class="token string">&quot;descheduler/v1alpha1&quot;</span>
<span class="token key atrule">kind</span><span class="token punctuation">:</span> <span class="token string">&quot;DeschedulerPolicy&quot;</span>
<span class="token key atrule">strategies</span><span class="token punctuation">:</span>
  <span class="token key atrule">&quot;RemoveDuplicates&quot;</span><span class="token punctuation">:</span>
     <span class="token key atrule">enabled</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
     <span class="token key atrule">params</span><span class="token punctuation">:</span>
       <span class="token key atrule">removeDuplicates</span><span class="token punctuation">:</span>
         <span class="token key atrule">excludeOwnerKinds</span><span class="token punctuation">:</span>
         <span class="token punctuation">-</span> <span class="token string">&quot;ReplicaSet&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>当前，没有与该策略关联的参数，要禁用该策略，也很简单，只需要配置成 false 即可：</p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> <span class="token string">&quot;descheduler/v1alpha1&quot;</span>
<span class="token key atrule">kind</span><span class="token punctuation">:</span> <span class="token string">&quot;DeschedulerPolicy&quot;</span>
<span class="token key atrule">strategies</span><span class="token punctuation">:</span>
  <span class="token key atrule">&quot;RemoveDuplicates&quot;</span><span class="token punctuation">:</span>
     <span class="token key atrule">enabled</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="_2-2、lownodeutilization"><a href="#_2-2、lownodeutilization" class="header-anchor">#</a> 2.2、LowNodeUtilization</h3> <p>该策略查找未充分利用的节点，并从其他节点驱逐 Pod，以便 <code>kube-scheudler</code> 重新将它们调度到未充分利用的节点上。该策略的参数可以通过字段 <code>nodeResourceUtilizationThresholds</code> 进行配置。</p> <p>节点的利用率不足可以通过配置 <code>thresholds</code> 阈值参数来确定，可以通过 CPU、内存和 Pod 数量的百分比进行配置。如果节点的使用率均低于所有阈值，则认为该节点未充分利用。</p> <p>此外，还有一个可配置的阈值 <code>targetThresholds</code>，该阈值用于计算可从中驱逐 Pod 的那些潜在节点，对于所有节点 <code>thresholds</code> 和 <code>targetThresholds</code> 之间的阈值被认为是合理使用的，不考虑驱逐。<code>targetThresholds</code> 阈值也可以针对 CPU、内存和 Pod 数量进行配置。<code>thresholds</code> 和 <code>targetThresholds</code> 可以根据你的集群需求进行动态调整，如下所示示例：</p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> <span class="token string">&quot;descheduler/v1alpha1&quot;</span>
<span class="token key atrule">kind</span><span class="token punctuation">:</span> <span class="token string">&quot;DeschedulerPolicy&quot;</span>
<span class="token key atrule">strategies</span><span class="token punctuation">:</span>
  <span class="token key atrule">&quot;LowNodeUtilization&quot;</span><span class="token punctuation">:</span>
     <span class="token key atrule">enabled</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
     <span class="token key atrule">params</span><span class="token punctuation">:</span>
       <span class="token key atrule">nodeResourceUtilizationThresholds</span><span class="token punctuation">:</span>
         <span class="token key atrule">thresholds</span><span class="token punctuation">:</span>
           <span class="token key atrule">&quot;cpu&quot;</span> <span class="token punctuation">:</span> <span class="token number">20</span>
           <span class="token key atrule">&quot;memory&quot;</span><span class="token punctuation">:</span> <span class="token number">20</span>
           <span class="token key atrule">&quot;pods&quot;</span><span class="token punctuation">:</span> <span class="token number">20</span>
         <span class="token key atrule">targetThresholds</span><span class="token punctuation">:</span>
           <span class="token key atrule">&quot;cpu&quot;</span> <span class="token punctuation">:</span> <span class="token number">50</span>
           <span class="token key atrule">&quot;memory&quot;</span><span class="token punctuation">:</span> <span class="token number">50</span>
           <span class="token key atrule">&quot;pods&quot;</span><span class="token punctuation">:</span> <span class="token number">50</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>和 <code>LowNodeUtilization</code> 策略关联的另一个参数是 <code>numberOfNodes</code>，只有当未充分利用的节点数大于该配置值的时候，才可以配置该参数来激活该策略，该参数对于大型集群非常有用，其中有一些节点可能会频繁使用或短期使用不足，默认情况下，<code>numberOfNodes</code> 为0。</p> <h3 id="_2-3、highnodeutilization"><a href="#_2-3、highnodeutilization" class="header-anchor">#</a> 2.3、HighNodeUtilization</h3> <p>该策略查找未充分利用的节点，并从节点中逐出POD，希望这些POD将被紧凑地调度到更少的节点中。此策略与节点自动缩放结合使用，旨在帮助触发未充分利用的节点的向下缩放。此策略必须与调度程序策略<code>MostRequestedPriority</code>一起使用。此策略的参数在<code>nodeResourceUtilizationThresholds</code>下配置。</p> <p>节点利用率不足由可配置的阈值确定。可以根据百分比为cpu、内存、POD数量和扩展资源配置阈值。百分比计算为节点上请求的当前资源与可分配的总资源之比。对于pod，这意味着节点上的pod数量是该节点pod容量集的一部分。</p> <p>如果一个节点的使用率低于所有节点的阈值（cpu、内存、POD数量和扩展资源），则该节点被视为未充分利用。目前，pods请求资源需求被考虑用于计算节点资源利用率。任何高于阈值的节点都被认为是适当利用的，不考虑逐出。</p> <p>thresholds参数可以根据您的集群需求进行调整。</p> <blockquote><p>请注意，此策略将POD从未充分利用的节点（使用率低于阈值的节点）中逐出，以便可以在适当利用的节点中重新创建POD。</p></blockquote> <p>如果任何未充分利用的节点数或适当利用的节点数为零，该策略将中止。</p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> <span class="token string">&quot;descheduler/v1alpha1&quot;</span>
<span class="token key atrule">kind</span><span class="token punctuation">:</span> <span class="token string">&quot;DeschedulerPolicy&quot;</span>
<span class="token key atrule">strategies</span><span class="token punctuation">:</span>
  <span class="token key atrule">&quot;HighNodeUtilization&quot;</span><span class="token punctuation">:</span>
     <span class="token key atrule">enabled</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
     <span class="token key atrule">params</span><span class="token punctuation">:</span>
       <span class="token key atrule">nodeResourceUtilizationThresholds</span><span class="token punctuation">:</span>
         <span class="token key atrule">thresholds</span><span class="token punctuation">:</span>
           <span class="token key atrule">&quot;cpu&quot;</span> <span class="token punctuation">:</span> <span class="token number">20</span>
           <span class="token key atrule">&quot;memory&quot;</span><span class="token punctuation">:</span> <span class="token number">20</span>
           <span class="token key atrule">&quot;pods&quot;</span><span class="token punctuation">:</span> <span class="token number">20</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h3 id="_2-4、removepodsviolatinginterpodantiaffinity"><a href="#_2-4、removepodsviolatinginterpodantiaffinity" class="header-anchor">#</a> 2.4、RemovePodsViolatingInterPodAntiAffinity</h3> <p>该策略可以确保从节点中删除违反 Pod 反亲和性的 Pod。比如某个节点上有 <code>podA</code> 这个 Pod，并且 <code>podB</code> 和 <code>podC</code>（在同一个节点上运行）具有禁止它们在同一个节点上运行的反亲和性规则，则 <code>podA</code> 将被从该节点上驱逐，以便 <code>podB</code> 和 <code>podC</code> 运行正常运行。当 <code>podB</code> 和 <code>podC</code> 已经运行在节点上后，反亲和性规则被创建就会发送这样的问题，目前没有和该策略相关联的配置参数，要禁用该策略，同样配置成 false 即可：</p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> <span class="token string">&quot;descheduler/v1alpha1&quot;</span>
<span class="token key atrule">kind</span><span class="token punctuation">:</span> <span class="token string">&quot;DeschedulerPolicy&quot;</span>
<span class="token key atrule">strategies</span><span class="token punctuation">:</span>
  <span class="token key atrule">&quot;RemovePodsViolatingInterPodAntiAffinity&quot;</span><span class="token punctuation">:</span>
     <span class="token key atrule">enabled</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="_2-5、removepodsviolatingnodeaffinity"><a href="#_2-5、removepodsviolatingnodeaffinity" class="header-anchor">#</a> 2.5、RemovePodsViolatingNodeAffinity</h3> <p>该策略确保从节点中删除违反节点亲和性的 Pod。比如名为 <code>podA</code> 的 Pod 被调度到了节点 <code>nodeA</code>，<code>podA</code> 在调度的时候满足了节点亲和性规则 <code>requiredDuringSchedulingIgnoredDuringExecution</code>，但是随着时间的推移，节点 <code>nodeA</code> 不再满足该规则了，那么如果另一个满足节点亲和性规则的节点 <code>nodeB</code> 可用，则 <code>podA</code> 将被从节点 <code>nodeA</code> 驱逐，如下所示的策略配置示例：</p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> <span class="token string">&quot;descheduler/v1alpha1&quot;</span>
<span class="token key atrule">kind</span><span class="token punctuation">:</span> <span class="token string">&quot;DeschedulerPolicy&quot;</span>
<span class="token key atrule">strategies</span><span class="token punctuation">:</span>
  <span class="token key atrule">&quot;RemovePodsViolatingNodeAffinity&quot;</span><span class="token punctuation">:</span>
    <span class="token key atrule">enabled</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
    <span class="token key atrule">params</span><span class="token punctuation">:</span>
      <span class="token key atrule">nodeAffinityType</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token string">&quot;requiredDuringSchedulingIgnoredDuringExecution&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="_2-6、removepodsviolatingnodetaints"><a href="#_2-6、removepodsviolatingnodetaints" class="header-anchor">#</a> 2.6、RemovePodsViolatingNodeTaints</h3> <p>该策略可以确保从节点中删除违反 <code>NoSchedule</code> 污点的 Pod。比如有一个名为 <code>podA</code> 的 Pod，通过配置容忍 <code>key=value:NoSchedule</code> 允许被调度到有该污点配置的节点上，如果节点的污点随后被更新或者删除了，则污点将不再被 Pods 的容忍满足，然后将被驱逐，如下所示配置策略：</p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> <span class="token string">&quot;descheduler/v1alpha1&quot;</span>
<span class="token key atrule">kind</span><span class="token punctuation">:</span> <span class="token string">&quot;DeschedulerPolicy&quot;</span>
<span class="token key atrule">strategies</span><span class="token punctuation">:</span>
  <span class="token key atrule">&quot;RemovePodsViolatingNodeTaints&quot;</span><span class="token punctuation">:</span>
    <span class="token key atrule">enabled</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="_2-7、removepodsviolatingtopologyspreadconstraint"><a href="#_2-7、removepodsviolatingtopologyspreadconstraint" class="header-anchor">#</a> 2.7、RemovePodsViolatingTopologySpreadConstraint</h3> <p>此策略确保从节点中逐出违反拓扑扩展约束的POD。具体地说，它尝试将平衡拓扑域所需的最小POD数逐出到每个约束的maxSkew内。此策略至少需要k8s版本1.18。</p> <p>默认情况下，此策略仅处理硬约束，将参数includeSoftConstraints设置为true将包括软约束。</p> <p>平衡拓扑域时不使用策略参数labelSelector，仅在逐出期间应用，以确定是否可以逐出pod。</p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> <span class="token string">&quot;descheduler/v1alpha1&quot;</span>
<span class="token key atrule">kind</span><span class="token punctuation">:</span> <span class="token string">&quot;DeschedulerPolicy&quot;</span>
<span class="token key atrule">strategies</span><span class="token punctuation">:</span>
  <span class="token key atrule">&quot;RemovePodsViolatingTopologySpreadConstraint&quot;</span><span class="token punctuation">:</span>
     <span class="token key atrule">enabled</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
     <span class="token key atrule">params</span><span class="token punctuation">:</span>
       <span class="token key atrule">includeSoftConstraints</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="_2-8、removepodshavingtoomanyrestarts"><a href="#_2-8、removepodshavingtoomanyrestarts" class="header-anchor">#</a> 2.8、RemovePodsHavingTooManyRestarts</h3> <p>此策略确保从节点中删除重启次数过多的POD。例如，一个带有EBS/PD的pod无法将卷/磁盘连接到实例，那么该pod应该重新调度到其他节点。它的参数包括podRestartThreshold，它是pod应该被逐出的重启次数（在所有符合条件的容器上求和），以及includingInitContainers，它确定是否应该在该计算中考虑初始化容器重启。</p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> <span class="token string">&quot;descheduler/v1alpha1&quot;</span>
<span class="token key atrule">kind</span><span class="token punctuation">:</span> <span class="token string">&quot;DeschedulerPolicy&quot;</span>
<span class="token key atrule">strategies</span><span class="token punctuation">:</span>
  <span class="token key atrule">&quot;RemovePodsHavingTooManyRestarts&quot;</span><span class="token punctuation">:</span>
     <span class="token key atrule">enabled</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
     <span class="token key atrule">params</span><span class="token punctuation">:</span>
       <span class="token key atrule">podsHavingTooManyRestarts</span><span class="token punctuation">:</span>
         <span class="token key atrule">podRestartThreshold</span><span class="token punctuation">:</span> <span class="token number">100</span>
         <span class="token key atrule">includingInitContainers</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h3 id="_2-9、podlifetime"><a href="#_2-9、podlifetime" class="header-anchor">#</a> 2.9、PodLifeTime</h3> <p>此策略将驱逐比<code>maxPodLifeTimeSeconds</code>早的POD。</p> <p>您还可以指定podStatusPhases以仅收回具有特定StatusPhases的pod，当前此参数仅限于Running和Pending。</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>apiVersion: <span class="token string">&quot;descheduler/v1alpha1&quot;</span>
kind: <span class="token string">&quot;DeschedulerPolicy&quot;</span>
strategies:
  <span class="token string">&quot;PodLifeTime&quot;</span><span class="token builtin class-name">:</span>
     enabled: <span class="token boolean">true</span>
     params:
       podLifeTime:
         maxPodLifeTimeSeconds: <span class="token number">86400</span>
         podStatusPhases:
         - <span class="token string">&quot;Pending&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h3 id="_2-10、removefailedpods"><a href="#_2-10、removefailedpods" class="header-anchor">#</a> 2.10、RemoveFailedPods</h3> <p>此策略将驱逐处于失败状态阶段的POD。您可以提供可选参数以按失败原因进行筛选。通过将可选参数<code>includingInitContainers</code>设置为true，可以将原因扩展为包括InitContainers的原因。您可以指定一个可选参数minPodLifeTimeSeconds，以收回早于指定秒数的pod。最后，您可以指定可选参数<code>ExcludeOwnerTypes</code>，如果某个pod将这些类型中的任何一种列为<code>OwnerRef</code>，则该pod将不会被考虑逐出。</p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> <span class="token string">&quot;descheduler/v1alpha1&quot;</span>
<span class="token key atrule">kind</span><span class="token punctuation">:</span> <span class="token string">&quot;DeschedulerPolicy&quot;</span>
<span class="token key atrule">strategies</span><span class="token punctuation">:</span>
  <span class="token key atrule">&quot;RemoveFailedPods&quot;</span><span class="token punctuation">:</span>
     <span class="token key atrule">enabled</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
     <span class="token key atrule">params</span><span class="token punctuation">:</span>
       <span class="token key atrule">failedPods</span><span class="token punctuation">:</span>
         <span class="token key atrule">reasons</span><span class="token punctuation">:</span>
         <span class="token punctuation">-</span> <span class="token string">&quot;NodeAffinity&quot;</span>
         <span class="token key atrule">includingInitContainers</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
         <span class="token key atrule">excludeOwnerKinds</span><span class="token punctuation">:</span>
         <span class="token punctuation">-</span> <span class="token string">&quot;Job&quot;</span>
         <span class="token key atrule">minPodLifeTimeSeconds</span><span class="token punctuation">:</span> <span class="token number">3600</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h2 id="_3、针对资源过滤"><a href="#_3、针对资源过滤" class="header-anchor">#</a> 3、针对资源过滤</h2> <h3 id="_3-1、namespace过滤"><a href="#_3-1、namespace过滤" class="header-anchor">#</a> 3.1、Namespace过滤</h3> <p>以下策略接受一个namespaces参数，该参数允许指定包含.</p> <ul><li><code>PodLifeTime</code></li> <li><code>RemovePodsHavingTooManyRestarts</code></li> <li><code>RemovePodsViolatingNodeTaints</code></li> <li><code>RemovePodsViolatingNodeAffinity</code></li> <li><code>RemovePodsViolatingInterPodAntiAffinity</code></li> <li><code>RemoveDuplicates</code></li> <li><code>RemovePodsViolatingTopologySpreadConstraint</code></li> <li><code>RemoveFailedPods</code></li></ul> <p>示例</p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> <span class="token string">&quot;descheduler/v1alpha1&quot;</span>
<span class="token key atrule">kind</span><span class="token punctuation">:</span> <span class="token string">&quot;DeschedulerPolicy&quot;</span>
<span class="token key atrule">strategies</span><span class="token punctuation">:</span>
  <span class="token key atrule">&quot;PodLifeTime&quot;</span><span class="token punctuation">:</span>
     <span class="token key atrule">enabled</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
     <span class="token key atrule">params</span><span class="token punctuation">:</span>
        <span class="token key atrule">podLifeTime</span><span class="token punctuation">:</span>
          <span class="token key atrule">maxPodLifeTimeSeconds</span><span class="token punctuation">:</span> <span class="token number">86400</span>
        <span class="token key atrule">namespaces</span><span class="token punctuation">:</span>
          <span class="token key atrule">include</span><span class="token punctuation">:</span>
          <span class="token punctuation">-</span> <span class="token string">&quot;namespace1&quot;</span>
          <span class="token punctuation">-</span> <span class="token string">&quot;namespace2&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>不包括</p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> <span class="token string">&quot;descheduler/v1alpha1&quot;</span>
<span class="token key atrule">kind</span><span class="token punctuation">:</span> <span class="token string">&quot;DeschedulerPolicy&quot;</span>
<span class="token key atrule">strategies</span><span class="token punctuation">:</span>
  <span class="token key atrule">&quot;PodLifeTime&quot;</span><span class="token punctuation">:</span>
     <span class="token key atrule">enabled</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
     <span class="token key atrule">params</span><span class="token punctuation">:</span>
        <span class="token key atrule">podLifeTime</span><span class="token punctuation">:</span>
          <span class="token key atrule">maxPodLifeTimeSeconds</span><span class="token punctuation">:</span> <span class="token number">86400</span>
        <span class="token key atrule">namespaces</span><span class="token punctuation">:</span>
          <span class="token key atrule">exclude</span><span class="token punctuation">:</span>
          <span class="token punctuation">-</span> <span class="token string">&quot;namespace1&quot;</span>
          <span class="token punctuation">-</span> <span class="token string">&quot;namespace2&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h3 id="_3-2、priority过滤"><a href="#_3-2、priority过滤" class="header-anchor">#</a> 3.2、Priority过滤</h3> <p>所有策略都可以配置优先级阈值，只有低于阈值的 pod 才能被驱逐。您可以通过设置<code>thresholdPriorityClassName</code>（将阈值设置为给定优先级类的值）或<code>thresholdPriority</code>（直接设置阈值）参数来指定此阈值。默认情况下，此阈值设置为<code>system-cluster-critical</code>优先级的值。</p> <p>注意：设置<code>evictSystemCriticalPods</code>为 true 会完全禁用优先级过滤。</p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> <span class="token string">&quot;descheduler/v1alpha1&quot;</span>
<span class="token key atrule">kind</span><span class="token punctuation">:</span> <span class="token string">&quot;DeschedulerPolicy&quot;</span>
<span class="token key atrule">strategies</span><span class="token punctuation">:</span>
  <span class="token key atrule">&quot;PodLifeTime&quot;</span><span class="token punctuation">:</span>
     <span class="token key atrule">enabled</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
     <span class="token key atrule">params</span><span class="token punctuation">:</span>
        <span class="token key atrule">podLifeTime</span><span class="token punctuation">:</span>
          <span class="token key atrule">maxPodLifeTimeSeconds</span><span class="token punctuation">:</span> <span class="token number">86400</span>
        <span class="token key atrule">thresholdPriority</span><span class="token punctuation">:</span> <span class="token number">10000</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h3 id="_3-3、label-过滤"><a href="#_3-3、label-过滤" class="header-anchor">#</a> 3.3、Label 过滤</h3> <p>策略包括</p> <ul><li><code>PodLifeTime</code></li> <li><code>RemovePodsHavingTooManyRestarts</code></li> <li><code>RemovePodsViolatingNodeTaints</code></li> <li><code>RemovePodsViolatingNodeAffinity</code></li> <li><code>RemovePodsViolatingInterPodAntiAffinity</code></li> <li><code>RemovePodsViolatingTopologySpreadConstraint</code></li> <li><code>RemoveFailedPods</code></li></ul> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> <span class="token string">&quot;descheduler/v1alpha1&quot;</span>
<span class="token key atrule">kind</span><span class="token punctuation">:</span> <span class="token string">&quot;DeschedulerPolicy&quot;</span>
<span class="token key atrule">strategies</span><span class="token punctuation">:</span>
  <span class="token key atrule">&quot;PodLifeTime&quot;</span><span class="token punctuation">:</span>
    <span class="token key atrule">enabled</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
    <span class="token key atrule">params</span><span class="token punctuation">:</span>
      <span class="token key atrule">podLifeTime</span><span class="token punctuation">:</span>
        <span class="token key atrule">maxPodLifeTimeSeconds</span><span class="token punctuation">:</span> <span class="token number">86400</span>
      <span class="token key atrule">labelSelector</span><span class="token punctuation">:</span>
        <span class="token key atrule">matchLabels</span><span class="token punctuation">:</span>
          <span class="token key atrule">component</span><span class="token punctuation">:</span> redis
        <span class="token key atrule">matchExpressions</span><span class="token punctuation">:</span>
          <span class="token punctuation">-</span> <span class="token punctuation">{</span><span class="token key atrule">key</span><span class="token punctuation">:</span> tier<span class="token punctuation">,</span> <span class="token key atrule">operator</span><span class="token punctuation">:</span> In<span class="token punctuation">,</span> <span class="token key atrule">values</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>cache<span class="token punctuation">]</span><span class="token punctuation">}</span>
          <span class="token punctuation">-</span> <span class="token punctuation">{</span><span class="token key atrule">key</span><span class="token punctuation">:</span> environment<span class="token punctuation">,</span> <span class="token key atrule">operator</span><span class="token punctuation">:</span> NotIn<span class="token punctuation">,</span> <span class="token key atrule">values</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>dev<span class="token punctuation">]</span><span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h3 id="_3-4、node-fit-过滤"><a href="#_3-4、node-fit-过滤" class="header-anchor">#</a> 3.4、node Fit 过滤</h3> <p>以下策略接受<code>nodeFit</code>可以优化调度的布尔参数</p> <ul><li><code>RemoveDuplicates</code></li> <li><code>LowNodeUtilization</code></li> <li><code>HighNodeUtilization</code></li> <li><code>RemovePodsViolatingInterPodAntiAffinity</code></li> <li><code>RemovePodsViolatingNodeAffinity</code></li> <li><code>RemovePodsViolatingNodeTaints</code></li> <li><code>RemovePodsViolatingTopologySpreadConstraint</code></li> <li><code>RemovePodsHavingTooManyRestarts</code></li> <li><code>RemoveFailedPods</code></li></ul> <p>如果设置为<code>true</code>descheduler 将考虑满足驱逐标准的 pod 是否适合其他节点，然后再驱逐它们。如果一个 Pod 不能被重新调度到另一个节点，它不会被驱逐。目前，在设置<code>nodeFit</code>为时考虑以下标准<code>true</code>：</p> <ul><li>一个<code>nodeSelector</code>的pod</li> <li>任何<code>Tolerations</code>对pod和任何<code>Taints</code>其他节点上</li> <li><code>nodeAffinity</code> 在pod上</li> <li>是否有任何其他节点被标记为 <code>unschedulable</code></li></ul> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> <span class="token string">&quot;descheduler/v1alpha1&quot;</span>
<span class="token key atrule">kind</span><span class="token punctuation">:</span> <span class="token string">&quot;DeschedulerPolicy&quot;</span>
<span class="token key atrule">strategies</span><span class="token punctuation">:</span>
  <span class="token key atrule">&quot;LowNodeUtilization&quot;</span><span class="token punctuation">:</span>
     <span class="token key atrule">enabled</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
     <span class="token key atrule">params</span><span class="token punctuation">:</span>
       <span class="token key atrule">nodeResourceUtilizationThresholds</span><span class="token punctuation">:</span>
         <span class="token key atrule">thresholds</span><span class="token punctuation">:</span>
           <span class="token key atrule">&quot;cpu&quot;</span> <span class="token punctuation">:</span> <span class="token number">20</span>
           <span class="token key atrule">&quot;memory&quot;</span><span class="token punctuation">:</span> <span class="token number">20</span>
           <span class="token key atrule">&quot;pods&quot;</span><span class="token punctuation">:</span> <span class="token number">20</span>
         <span class="token key atrule">targetThresholds</span><span class="token punctuation">:</span>
           <span class="token key atrule">&quot;cpu&quot;</span> <span class="token punctuation">:</span> <span class="token number">50</span>
           <span class="token key atrule">&quot;memory&quot;</span><span class="token punctuation">:</span> <span class="token number">50</span>
           <span class="token key atrule">&quot;pods&quot;</span><span class="token punctuation">:</span> <span class="token number">50</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h2 id="_4、pod驱逐的原则"><a href="#_4、pod驱逐的原则" class="header-anchor">#</a> 4、pod驱逐的原则</h2> <ul><li><a href="https://kubernetes.io/docs/tasks/administer-cluster/guaranteed-scheduling-critical-addon-pods/" target="_blank" rel="noopener noreferrer">关键 pod<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>（将 priorityClassName 设置为 system-cluster-critical 或 system-node-critical）永远不会被驱逐（除非<code>evictSystemCriticalPods: true</code>已设置）。</li> <li>不属于 ReplicationController、ReplicaSet(Deployment)、StatefulSet 或 Job 的 Pod（静态或镜像 Pod 或独立 Pod）永远不会被驱逐，因为这些 Pod 不会被重新创建。</li> <li>与 DaemonSet 关联的 Pod 永远不会被驱逐。</li> <li>具有本地存储的 Pod 永远不会被驱逐（除非<code>evictLocalStoragePods: true</code>已设置）。</li> <li>带有 PVC 的 Pod 被驱逐（除非<code>ignorePvcPods: true</code>设置）。</li> <li>在<code>LowNodeUtilization</code>和 中<code>RemovePodsViolatingInterPodAntiAffinity</code>，pod 会按优先级从低到高逐出，如果它们具有相同的优先级，则尽力而为的 pod 会在可爆裂和有保证的 pod 之前被逐出。</li> <li>带有注释的所有类型的 pod<code>descheduler.alpha.kubernetes.io/evict</code>都有资格被驱逐。此注释用于覆盖防止驱逐的检查，用户可以选择驱逐哪个 pod。用户应该知道如何以及是否会重新创建 pod。</li> <li>默认情况下不会驱逐具有非 nil DeletionTimestamp 的 Pod。</li></ul> <h2 id="_5、安装"><a href="#_5、安装" class="header-anchor">#</a> 5、安装</h2> <h3 id="_5-1、安装metrics-server"><a href="#_5-1、安装metrics-server" class="header-anchor">#</a> 5.1、安装metrics-server</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>https://github.com/kubernetes-sigs/metrics-server/archive/v0.3.6.tar.gz
tar -zxvf v0.3.6.tar.gz
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>修改Metrics-Server配置文件</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>cd metrics-server-0.3.6/deploy/1.8+/
vim metrics-server-deployment.yaml
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>vim metrics-server-deployment.yaml文件</p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token punctuation">---</span>
<span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> ServiceAccount
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> metrics<span class="token punctuation">-</span>server
  <span class="token key atrule">namespace</span><span class="token punctuation">:</span> kube<span class="token punctuation">-</span>system
<span class="token punctuation">---</span>
<span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> apps/v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Deployment
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> metrics<span class="token punctuation">-</span>server
  <span class="token key atrule">namespace</span><span class="token punctuation">:</span> kube<span class="token punctuation">-</span>system
  <span class="token key atrule">labels</span><span class="token punctuation">:</span>
    <span class="token key atrule">k8s-app</span><span class="token punctuation">:</span> metrics<span class="token punctuation">-</span>server
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">selector</span><span class="token punctuation">:</span>
    <span class="token key atrule">matchLabels</span><span class="token punctuation">:</span>
      <span class="token key atrule">k8s-app</span><span class="token punctuation">:</span> metrics<span class="token punctuation">-</span>server
  <span class="token key atrule">template</span><span class="token punctuation">:</span>
    <span class="token key atrule">metadata</span><span class="token punctuation">:</span>
      <span class="token key atrule">name</span><span class="token punctuation">:</span> metrics<span class="token punctuation">-</span>server
      <span class="token key atrule">labels</span><span class="token punctuation">:</span>
        <span class="token key atrule">k8s-app</span><span class="token punctuation">:</span> metrics<span class="token punctuation">-</span>server
    <span class="token key atrule">spec</span><span class="token punctuation">:</span>
      <span class="token key atrule">serviceAccountName</span><span class="token punctuation">:</span> metrics<span class="token punctuation">-</span>server
      <span class="token key atrule">volumes</span><span class="token punctuation">:</span>
      <span class="token comment"># mount in tmp so we can safely use from-scratch images and/or read-only containers</span>
      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> tmp<span class="token punctuation">-</span>dir
        <span class="token key atrule">emptyDir</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
      <span class="token key atrule">containers</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> metrics<span class="token punctuation">-</span>server
        <span class="token comment"># 修改image 和 imagePullPolicy</span>
        <span class="token key atrule">image</span><span class="token punctuation">:</span> mirrorgooglecontainers/metrics<span class="token punctuation">-</span>server<span class="token punctuation">-</span>amd64<span class="token punctuation">:</span>v0.3.6
        <span class="token key atrule">imagePullPolicy</span><span class="token punctuation">:</span> IfNotPresent
        <span class="token comment"># 新增command配置</span>
        <span class="token key atrule">command</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> /metrics<span class="token punctuation">-</span>server
        <span class="token punctuation">-</span> <span class="token punctuation">-</span><span class="token punctuation">-</span>kubelet<span class="token punctuation">-</span>insecure<span class="token punctuation">-</span>tls
        <span class="token punctuation">-</span> <span class="token punctuation">-</span><span class="token punctuation">-</span>kubelet<span class="token punctuation">-</span>preferred<span class="token punctuation">-</span>address<span class="token punctuation">-</span>types=InternalDNS<span class="token punctuation">,</span>InternalIP<span class="token punctuation">,</span>ExternalDNS<span class="token punctuation">,</span>ExternalIP<span class="token punctuation">,</span>Hostname
        <span class="token key atrule">volumeMounts</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> tmp<span class="token punctuation">-</span>dir
          <span class="token key atrule">mountPath</span><span class="token punctuation">:</span> /tmp
        <span class="token comment"># 新增resources配置</span>
        <span class="token key atrule">resources</span><span class="token punctuation">:</span>
          <span class="token key atrule">limits</span><span class="token punctuation">:</span>
            <span class="token key atrule">cpu</span><span class="token punctuation">:</span> 300m
            <span class="token key atrule">memory</span><span class="token punctuation">:</span> 200Mi
          <span class="token key atrule">requests</span><span class="token punctuation">:</span>
            <span class="token key atrule">cpu</span><span class="token punctuation">:</span> 200m
            <span class="token key atrule">memory</span><span class="token punctuation">:</span> 100Mi　　
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br></div></div><p>安装Metrics-Server</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>kubectl apply -f metrics-server-0.3.6/deploy/1.8+/
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>测试</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>kubectl get --raw <span class="token string">&quot;/apis/metrics.k8s.io/v1beta1/pods&quot;</span> <span class="token operator">|</span>jq
kubectl <span class="token function">top</span> nodes
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="_5-2、安装descheduler"><a href="#_5-2、安装descheduler" class="header-anchor">#</a> 5.2、安装descheduler</h3> <p>添加仓库</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>helm repo <span class="token function">add</span> descheduler https://kubernetes-sigs.github.io/descheduler/
helm <span class="token function">install</span> my-release --namespace kube-system descheduler/descheduler
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>介绍</p> <p>此图表使用<a href="https://helm.sh/" target="_blank" rel="noopener noreferrer">Helm<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>包管理器在<a href="http://kubernetes.io/" target="_blank" rel="noopener noreferrer">Kubernetes<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>集群上引导<a href="https://github.com/kubernetes-sigs/descheduler/" target="_blank" rel="noopener noreferrer">调度程序<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>cron 作业。</p> <p>先决条件</p> <ul><li>Kubernetes 1.14+</li></ul> <p>helm安装</p> <p>要使用发行版名称安装helm<code>my-release</code></p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>helm <span class="token function">install</span> --namespace kube-system my-release descheduler/descheduler
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>该命令以默认配置在 Kubernetes 集群上部署<em>descheduler</em>。这配置 部分列出了可以在安装过程中配置的参数。</p> <blockquote><p><strong>提示</strong>：列出所有版本使用<code>helm list</code></p></blockquote> <p><strong>helm卸载</strong></p> <p>要卸载/删除<code>my-release</code>部署：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>helm delete my-release
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>该命令删除与图表关联的所有 Kubernetes 组件并删除发布。</p> <p><strong>配置参数</strong></p> <p>下表列出了<em>调度器</em>图表的可配置参数及其默认值。</p> <table><thead><tr><th>范围</th> <th style="text-align:center;">描述</th> <th>默认</th></tr></thead> <tbody><tr><td><code>kind</code></td> <td style="text-align:center;">用作 CronJob 或部署</td> <td><code>CronJob</code></td></tr> <tr><td><code>image.repository</code></td> <td style="text-align:center;">要使用的 Docker 存储库</td> <td><code>k8s.gcr.io/descheduler/descheduler</code></td></tr> <tr><td><code>image.tag</code></td> <td style="text-align:center;">要使用的 Docker 标签</td> <td><code>v[chart appVersion]</code></td></tr> <tr><td><code>image.pullPolicy</code></td> <td style="text-align:center;">Docker 镜像拉取策略</td> <td><code>IfNotPresent</code></td></tr> <tr><td><code>imagePullSecrets</code></td> <td style="text-align:center;">Docker 存储库的秘密</td> <td><code>[]</code></td></tr> <tr><td><code>nameOverride</code></td> <td style="text-align:center;">部分覆盖<code>descheduler.fullname</code>模板的字符串（将添加发布名称）</td> <td><code>&quot;&quot;</code></td></tr> <tr><td><code>fullnameOverride</code></td> <td style="text-align:center;">完全覆盖<code>descheduler.fullname</code>模板的字符串</td> <td><code>&quot;&quot;</code></td></tr> <tr><td><code>cronJobApiVersion</code></td> <td style="text-align:center;">CronJob API 组版本</td> <td><code>&quot;batch/v1&quot;</code></td></tr> <tr><td><code>schedule</code></td> <td style="text-align:center;">这个cron时间表运行<em>descheduler</em>上工作</td> <td><code>&quot;*/2 * * * *&quot;</code></td></tr> <tr><td><code>startingDeadlineSeconds</code></td> <td style="text-align:center;">如果设置，<code>startingDeadlineSeconds</code>则为<em>调度程序</em>作业配置</td> <td><code>nil</code></td></tr> <tr><td><code>successfulJobsHistoryLimit</code></td> <td style="text-align:center;">如果设置，<code>successfulJobsHistoryLimit</code>则为<em>调度程序</em>作业配置</td> <td><code>nil</code></td></tr> <tr><td><code>failedJobsHistoryLimit</code></td> <td style="text-align:center;">如果设置，<code>failedJobsHistoryLimit</code>则为<em>调度程序</em>作业配置</td> <td><code>nil</code></td></tr> <tr><td><code>deschedulingInterval</code></td> <td style="text-align:center;">如果使用 kind:Deployment，则设置连续调度程序执行之间的时间。</td> <td><code>5m</code></td></tr> <tr><td><code>cmdOptions</code></td> <td style="text-align:center;">传递给<em>descheduler</em>命令的选项</td> <td><em>参见 values.yaml</em></td></tr> <tr><td><code>deschedulerPolicy.strategies</code></td> <td style="text-align:center;">要应用的<em>调度器</em>策略</td> <td><em>参见 values.yaml</em></td></tr> <tr><td><code>priorityClassName</code></td> <td style="text-align:center;">要添加到 pod 的优先级类的名称</td> <td><code>system-cluster-critical</code></td></tr> <tr><td><code>rbac.create</code></td> <td style="text-align:center;">如果<code>true</code>，创建和使用 RBAC 资源</td> <td><code>true</code></td></tr> <tr><td><code>podSecurityPolicy.create</code></td> <td style="text-align:center;">如果<code>true</code>，创建 PodSecurityPolicy</td> <td><code>true</code></td></tr> <tr><td><code>resources</code></td> <td style="text-align:center;">调度器容器 CPU 和内存请求/限制</td> <td><em>参见 values.yaml</em></td></tr> <tr><td><code>serviceAccount.create</code></td> <td style="text-align:center;">如果<code>true</code>，为 cron 作业创建一个服务帐户</td> <td><code>true</code></td></tr> <tr><td><code>serviceAccount.name</code></td> <td style="text-align:center;">要使用的服务帐户的名称，如果未设置且 create 为 true，则使用 fullname 模板生成名称</td> <td><code>nil</code></td></tr> <tr><td><code>nodeSelector</code></td> <td style="text-align:center;">用于在特定节点上运行调度程序 cronjob 的节点选择器</td> <td><code>nil</code></td></tr> <tr><td><code>tolerations</code></td> <td style="text-align:center;">在特定节点上运行调度程序 cronjob 的容忍度</td> <td><code>nil</code></td></tr></tbody></table> <p>默认策略生成</p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code>  <span class="token key atrule">strategies</span><span class="token punctuation">:</span>
    <span class="token key atrule">RemoveDuplicates</span><span class="token punctuation">:</span>
      <span class="token key atrule">enabled</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
    <span class="token key atrule">RemovePodsViolatingNodeTaints</span><span class="token punctuation">:</span>
      <span class="token key atrule">enabled</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
    <span class="token key atrule">RemovePodsViolatingNodeAffinity</span><span class="token punctuation">:</span>
      <span class="token key atrule">enabled</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
      <span class="token key atrule">params</span><span class="token punctuation">:</span>
        <span class="token key atrule">nodeAffinityType</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> requiredDuringSchedulingIgnoredDuringExecution
    <span class="token key atrule">RemovePodsViolatingInterPodAntiAffinity</span><span class="token punctuation">:</span>
      <span class="token key atrule">enabled</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
    <span class="token key atrule">LowNodeUtilization</span><span class="token punctuation">:</span>
      <span class="token key atrule">enabled</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
      <span class="token key atrule">params</span><span class="token punctuation">:</span>
        <span class="token key atrule">nodeResourceUtilizationThresholds</span><span class="token punctuation">:</span>
          <span class="token key atrule">thresholds</span><span class="token punctuation">:</span>
            <span class="token key atrule">cpu</span><span class="token punctuation">:</span> <span class="token number">20</span>
            <span class="token key atrule">memory</span><span class="token punctuation">:</span> <span class="token number">20</span>
            <span class="token key atrule">pods</span><span class="token punctuation">:</span> <span class="token number">20</span>
          <span class="token key atrule">targetThresholds</span><span class="token punctuation">:</span>
            <span class="token key atrule">cpu</span><span class="token punctuation">:</span> <span class="token number">50</span>
            <span class="token key atrule">memory</span><span class="token punctuation">:</span> <span class="token number">50</span>
            <span class="token key atrule">pods</span><span class="token punctuation">:</span> <span class="token number">50</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><h2 id="_6、测试驱逐"><a href="#_6、测试驱逐" class="header-anchor">#</a> 6、测试驱逐</h2> <p>测试驱逐</p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> apps/v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Deployment
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> nginx<span class="token punctuation">-</span>deployment<span class="token punctuation">-</span>basic
  <span class="token key atrule">labels</span><span class="token punctuation">:</span>
    <span class="token key atrule">app</span><span class="token punctuation">:</span> nginx
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">replicas</span><span class="token punctuation">:</span> <span class="token number">3</span>
  <span class="token key atrule">selector</span><span class="token punctuation">:</span>
    <span class="token key atrule">matchLabels</span><span class="token punctuation">:</span>
      <span class="token key atrule">app</span><span class="token punctuation">:</span> nginx
  <span class="token key atrule">template</span><span class="token punctuation">:</span>
    <span class="token key atrule">metadata</span><span class="token punctuation">:</span>
      <span class="token key atrule">labels</span><span class="token punctuation">:</span>
        <span class="token key atrule">app</span><span class="token punctuation">:</span> nginx
    <span class="token key atrule">spec</span><span class="token punctuation">:</span>
      <span class="token key atrule">containers</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> nginx
        <span class="token key atrule">image</span><span class="token punctuation">:</span> nginx<span class="token punctuation">:</span>1.7.9
        <span class="token key atrule">ports</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> <span class="token key atrule">containerPort</span><span class="token punctuation">:</span> <span class="token number">80</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><div class="language-sh line-numbers-mode"><pre class="language-sh"><code>kubectl apply -f nginx.yaml
kubectl get pod -n default -o wide
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div class="language- line-numbers-mode"><pre class="language-text"><code>NAME                                      READY   STATUS    RESTARTS   AGE     IP               NODE                NOMINATED NODE   READINESS GATES
nginx-deployment-basic-76bf4969df-82kbf   1/1     Running   0          4m40s   10.244.206.168   k8s-10.165.24.170   &lt;none&gt;           &lt;none&gt;
nginx-deployment-basic-76bf4969df-m7nl6   1/1     Running   0          4m40s   10.244.37.104    k8s-10.165.24.169   &lt;none&gt;           &lt;none&gt;
nginx-deployment-basic-76bf4969df-tv6zv   1/1     Running   0          4m40s   10.244.205.218   k8s-10.165.24.168   &lt;none&gt;           &lt;none&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><img src="https://raw.githubusercontent.com/lzq70112/images/master/blog/image-20211130152208364.png" alt="image-20211130152208364"></p> <p>触发策略</p> <p><img src="https://raw.githubusercontent.com/lzq70112/images/master/blog/image-20211130200811536.png" alt="image-20211130200811536"></p> <p><img src="https://raw.githubusercontent.com/lzq70112/images/master/blog/image-20211130200733541.png" alt="image-20211130200733541"></p> <div class="language- line-numbers-mode"><pre class="language-text"><code>I1130 12:04:10.866453       1 named_certificates.go:53] &quot;Loaded SNI cert&quot; index=0 certName=&quot;self-signed loopback&quot; certDetail=&quot;\&quot;apiserver-loopback-client@1638273850\&quot; [serving] validServingFor=[apiserver-loopback-client] issuer=\&quot;apiserver-loopback-client-ca@1638273850\&quot; (2021-11-30 11:04:10 +0000 UTC to 2022-11-30 11:04:10 +0000 UTC (now=2021-11-30 12:04:10.866373593 +0000 UTC))&quot;
I1130 12:04:10.866600       1 secure_serving.go:195] Serving securely on [::]:10258
I1130 12:04:10.866742       1 tlsconfig.go:240] &quot;Starting DynamicServingCertificateController&quot;
I1130 12:04:10.892135       1 node.go:46] &quot;Node lister returned empty list, now fetch directly&quot;
I1130 12:04:10.900951       1 pod_antiaffinity.go:81] &quot;Processing node&quot; node=&quot;k8s-10.165.24.168&quot;
I1130 12:04:10.968112       1 pod_antiaffinity.go:81] &quot;Processing node&quot; node=&quot;k8s-10.165.24.169&quot;
I1130 12:04:11.040374       1 pod_antiaffinity.go:81] &quot;Processing node&quot; node=&quot;k8s-10.165.24.170&quot;
I1130 12:04:11.111586       1 node_affinity.go:75] &quot;Executing for nodeAffinityType&quot; nodeAffinity=&quot;requiredDuringSchedulingIgnoredDuringExecution&quot;
I1130 12:04:11.111629       1 node_affinity.go:80] &quot;Processing node&quot; node=&quot;k8s-10.165.24.168&quot;
I1130 12:04:11.156870       1 node.go:169] &quot;Pod fits on node&quot; pod=&quot;default/nginx-deployment-basic-76bf4969df-gx7fk&quot; node=&quot;k8s-10.165.24.168&quot;
I1130 12:04:11.156917       1 node.go:169] &quot;Pod fits on node&quot; pod=&quot;default/nginx-deployment-basic-76bf4969df-kvhwq&quot; node=&quot;k8s-10.165.24.168&quot;
I1130 12:04:11.156985       1 node.go:169] &quot;Pod fits on node&quot; pod=&quot;kedacom-project-namespace/cephfs-provisioner-6cb45d4d4-jn2gl&quot; node=&quot;k8s-10.165.24.168&quot;
I1130 12:04:11.157042       1 node.go:169] &quot;Pod fits on node&quot; pod=&quot;kedacom-project-namespace/dol-elasticsearch-78-exporter-7977b8b59d-gc2jf&quot; node=&quot;k8s-10.165.24.168&quot;
I1130 12:04:11.157069       1 node.go:169] &quot;Pod fits on node&quot; pod=&quot;kedacom-project-namespace/dol-elasticsearch-exporter-58d4647d54-vpmsr&quot; node=&quot;k8s-10.165.24.168&quot;
I1130 12:04:11.157204       1 node.go:169] &quot;Pod fits on node&quot; pod=&quot;kube-system/kube-state-metrics-6986f4f675-zgwpg&quot; node=&quot;k8s-10.165.24.168&quot;
I1130 12:04:11.157249       1 node_affinity.go:80] &quot;Processing node&quot; node=&quot;k8s-10.165.24.169&quot;
I1130 12:04:11.213063       1 node.go:169] &quot;Pod fits on node&quot; pod=&quot;kedacom-project-namespace/alertmanager-1&quot; node=&quot;k8s-10.165.24.169&quot;
I1130 12:04:11.213147       1 node.go:169] &quot;Pod fits on node&quot; pod=&quot;kedacom-project-namespace/dol-prometheus-0&quot; node=&quot;k8s-10.165.24.169&quot;
I1130 12:04:11.213275       1 node_affinity.go:80] &quot;Processing node&quot; node=&quot;k8s-10.165.24.170&quot;
I1130 12:04:11.268428       1 node.go:169] &quot;Pod fits on node&quot; pod=&quot;default/nginx-deployment-basic-76bf4969df-l5qcn&quot; node=&quot;k8s-10.165.24.170&quot;
I1130 12:04:11.268494       1 node.go:169] &quot;Pod fits on node&quot; pod=&quot;kedacom-project-namespace/alertmanager-0&quot; node=&quot;k8s-10.165.24.170&quot;
I1130 12:04:11.268624       1 node.go:169] &quot;Pod fits on node&quot; pod=&quot;kedacom-project-namespace/dol-prometheus-1&quot; node=&quot;k8s-10.165.24.170&quot;
I1130 12:04:11.268848       1 node_taint.go:81] &quot;Processing node&quot; node=&quot;k8s-10.165.24.168&quot;
I1130 12:04:11.312521       1 node_taint.go:81] &quot;Processing node&quot; node=&quot;k8s-10.165.24.169&quot;
I1130 12:04:11.370280       1 node_taint.go:81] &quot;Processing node&quot; node=&quot;k8s-10.165.24.170&quot;
I1130 12:04:11.608101       1 nodeutilization.go:164] &quot;Node is underutilized&quot; node=&quot;k8s-10.165.24.168&quot; usage=map[cpu:4225m memory:34851Mi pods:33] usagePercentage=map[cpu:35.208333333333336 memory:54.18162323038457 pods:30]
I1130 12:04:11.608182       1 nodeutilization.go:167] &quot;Node is overutilized&quot; node=&quot;k8s-10.165.24.169&quot; usage=map[cpu:5825m memory:52197Mi pods:42] usagePercentage=map[cpu:48.541666666666664 memory:81.14883899332538 pods:38.18181818181818]
I1130 12:04:11.608215       1 nodeutilization.go:167] &quot;Node is overutilized&quot; node=&quot;k8s-10.165.24.170&quot; usage=map[cpu:5225m memory:48717Mi pods:51] usagePercentage=map[cpu:43.541666666666664 memory:75.73860546080873 pods:46.36363636363637]
I1130 12:04:11.608239       1 lownodeutilization.go:100] &quot;Criteria for a node under utilization&quot; CPU=60 Mem=60 Pods=60
I1130 12:04:11.608276       1 lownodeutilization.go:101] &quot;Number of underutilized nodes&quot; totalNumber=1
I1130 12:04:11.608309       1 lownodeutilization.go:114] &quot;Criteria for a node above target utilization&quot; CPU=62 Mem=62 Pods=62
I1130 12:04:11.608326       1 lownodeutilization.go:115] &quot;Number of overutilized nodes&quot; totalNumber=2
I1130 12:04:11.608375       1 nodeutilization.go:223] &quot;Total capacity to be moved&quot; CPU=3215 Mem=5273266749 Pods=35
I1130 12:04:11.608399       1 nodeutilization.go:226] &quot;Evicting pods from node&quot; node=&quot;k8s-10.165.24.169&quot; usage=map[cpu:5825m memory:52197Mi pods:42]
I1130 12:04:11.608700       1 nodeutilization.go:229] &quot;Pods on node&quot; node=&quot;k8s-10.165.24.169&quot; allPods=42 nonRemovablePods=40 removablePods=2
I1130 12:04:11.608745       1 nodeutilization.go:236] &quot;Evicting pods based on priority, if they have same priority, they'll be evicted based on QoS tiers&quot;
I1130 12:04:11.649119       1 evictions.go:130] &quot;Evicted pod&quot; pod=&quot;kedacom-project-namespace/alertmanager-1&quot; reason=&quot;LowNodeUtilization&quot;
I1130 12:04:11.649416       1 nodeutilization.go:269] &quot;Evicted pods&quot; pod=&quot;kedacom-project-namespace/alertmanager-1&quot; err=&lt;nil&gt;
I1130 12:04:11.649457       1 nodeutilization.go:294] &quot;Updated node usage&quot; node=&quot;k8s-10.165.24.169&quot; CPU=5725 Mem=54195650560 Pods=41
I1130 12:04:11.650289       1 event.go:291] &quot;Event occurred&quot; object=&quot;kedacom-project-namespace/alertmanager-1&quot; kind=&quot;Pod&quot; apiVersion=&quot;v1&quot; type=&quot;Normal&quot; reason=&quot;Descheduled&quot; message=&quot;pod evicted by sigs.k8s.io/deschedulerLowNodeUtilization&quot;
I1130 12:04:11.672580       1 evictions.go:130] &quot;Evicted pod&quot; pod=&quot;kedacom-project-namespace/dol-prometheus-0&quot; reason=&quot;LowNodeUtilization&quot;
I1130 12:04:11.672854       1 nodeutilization.go:269] &quot;Evicted pods&quot; pod=&quot;kedacom-project-namespace/dol-prometheus-0&quot; err=&lt;nil&gt;
I1130 12:04:11.673048       1 nodeutilization.go:294] &quot;Updated node usage&quot; node=&quot;k8s-10.165.24.169&quot; CPU=5625 Mem=52048166912 Pods=40
I1130 12:04:11.673132       1 nodeutilization.go:240] &quot;Evicted pods from node&quot; node=&quot;k8s-10.165.24.169&quot; evictedPods=2 usage=map[cpu:5625m memory:49637Mi pods:40]
I1130 12:04:11.673136       1 event.go:291] &quot;Event occurred&quot; object=&quot;kedacom-project-namespace/dol-prometheus-0&quot; kind=&quot;Pod&quot; apiVersion=&quot;v1&quot; type=&quot;Normal&quot; reason=&quot;Descheduled&quot; message=&quot;pod evicted by sigs.k8s.io/deschedulerLowNodeUtilization&quot;
I1130 12:04:11.673178       1 nodeutilization.go:226] &quot;Evicting pods from node&quot; node=&quot;k8s-10.165.24.170&quot; usage=map[cpu:5225m memory:48717Mi pods:51]
I1130 12:04:11.673775       1 nodeutilization.go:229] &quot;Pods on node&quot; node=&quot;k8s-10.165.24.170&quot; allPods=51 nonRemovablePods=48 removablePods=3
I1130 12:04:11.673829       1 nodeutilization.go:236] &quot;Evicting pods based on priority, if they have same priority, they'll be evicted based on QoS tiers&quot;
I1130 12:04:11.700919       1 evictions.go:130] &quot;Evicted pod&quot; pod=&quot;default/nginx-deployment-basic-76bf4969df-l5qcn&quot; reason=&quot;LowNodeUtilization&quot;
I1130 12:04:11.701078       1 nodeutilization.go:269] &quot;Evicted pods&quot; pod=&quot;default/nginx-deployment-basic-76bf4969df-l5qcn&quot; err=&lt;nil&gt;
I1130 12:04:11.701126       1 nodeutilization.go:294] &quot;Updated node usage&quot; node=&quot;k8s-10.165.24.170&quot; CPU=5225 Mem=51083476992 Pods=50
I1130 12:04:11.701257       1 event.go:291] &quot;Event occurred&quot; object=&quot;default/nginx-deployment-basic-76bf4969df-l5qcn&quot; kind=&quot;Pod&quot; apiVersion=&quot;v1&quot; type=&quot;Normal&quot; reason=&quot;Descheduled&quot; message=&quot;pod evicted by sigs.k8s.io/deschedulerLowNodeUtilization&quot;
I1130 12:04:11.728656       1 evictions.go:130] &quot;Evicted pod&quot; pod=&quot;kedacom-project-namespace/alertmanager-0&quot; reason=&quot;LowNodeUtilization&quot;
I1130 12:04:11.728832       1 nodeutilization.go:269] &quot;Evicted pods&quot; pod=&quot;kedacom-project-namespace/alertmanager-0&quot; err=&lt;nil&gt;
I1130 12:04:11.728873       1 nodeutilization.go:294] &quot;Updated node usage&quot; node=&quot;k8s-10.165.24.170&quot; CPU=5125 Mem=50546606080 Pods=49
I1130 12:04:11.729218       1 event.go:291] &quot;Event occurred&quot; object=&quot;kedacom-project-namespace/alertmanager-0&quot; kind=&quot;Pod&quot; apiVersion=&quot;v1&quot; type=&quot;Normal&quot; reason=&quot;Descheduled&quot; message=&quot;pod evicted by sigs.k8s.io/deschedulerLowNodeUtilization&quot;
I1130 12:04:11.771287       1 evictions.go:130] &quot;Evicted pod&quot; pod=&quot;kedacom-project-namespace/dol-prometheus-1&quot; reason=&quot;LowNodeUtilization&quot;
I1130 12:04:11.771445       1 nodeutilization.go:269] &quot;Evicted pods&quot; pod=&quot;kedacom-project-namespace/dol-prometheus-1&quot; err=&lt;nil&gt;
I1130 12:04:11.771478       1 nodeutilization.go:294] &quot;Updated node usage&quot; node=&quot;k8s-10.165.24.170&quot; CPU=5025 Mem=48399122432 Pods=48
I1130 12:04:11.771525       1 nodeutilization.go:240] &quot;Evicted pods from node&quot; node=&quot;k8s-10.165.24.170&quot; evictedPods=3 usage=map[cpu:5025m memory:46157Mi pods:48]
I1130 12:04:11.771574       1 lownodeutilization.go:163] &quot;Total number of pods evicted&quot; evictedPods=5
I1130 12:04:11.771599       1 descheduler.go:152] &quot;Number of evicted pods&quot; totalEvicted=5
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br></div></div></div></div> <!----> <div class="page-edit"><div class="edit-link"><a href="https://github.com/lzq70112/lzq70112.github.io/edit/master/docs/《K8S》学习笔记/102.descheduler技术打烊.md" target="_blank" rel="noopener noreferrer">编辑</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="tags"><a href="/tags/?tag=k8s" title="标签">#k8s</a><a href="/tags/?tag=%E5%A5%87%E5%B7%A7%E6%B7%AB%E6%8A%80" title="标签">#奇巧淫技</a></div> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2022/07/18, 19:58:00</span></div></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/pages/b15e15699/" class="page-nav-centre page-nav-centre-prev"><div class="tooltip">K8S的端口转发</div></a> <a href="/pages/K8S103/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">K8S全量备份迁移还原</div></a></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/pages/b15e15699/" class="prev">K8S的端口转发</a></span> <span class="next"><a href="/pages/K8S103/">K8S全量备份迁移还原</a>→
      </span></p></div></div></div> <div class="article-list"><div class="article-title"><a href="/archives/" class="iconfont icon-bi">最近更新</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/pages/ansible8/"><div>
            ansibleplaybook常用模块
            <!----></div></a> <span class="date">06-22</span></dt></dl><dl><dd>02</dd> <dt><a href="/pages/k8s110/"><div>
            kubelet硬件资源驱逐策略
            <!----></div></a> <span class="date">06-03</span></dt></dl><dl><dd>03</dd> <dt><a href="/pages/k8s111/"><div>
            k8s云存储nfs的nolock详解
            <!----></div></a> <span class="date">06-03</span></dt></dl> <dl><dd></dd> <dt><a href="/archives/" class="more">更多文章&gt;</a></dt></dl></div></div></main></div> <div class="footer"><div class="icons"><a href="mailto:498510210@qq.com" title="发邮件" target="_blank" class="iconfont icon-youjian"></a><a href="https://github.com/lzq70112" title="GitHub" target="_blank" class="iconfont icon-github"></a><a href="https://music.163.com/#/playlist?id=755597173" title="听音乐" target="_blank" class="iconfont icon-erji"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
    | Copyright © 2019-2022
    <span>xiongmao | <a href="https://github.com/xugaoyi/vuepress-theme-vdoing/blob/master/LICENSE" target="_blank" rel="nofollow">MIT License</a> <a href="https://hongwei888.com/sitemap.xml" target="_blank">站点地图</a></span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <div class="body-bg" style="background:url() center center / cover no-repeat;opacity:0.5;"></div> <!----> <!----></div><div class="global-ui"><div></div></div></div>
    <script src="/assets/js/app.e7221624.js" defer></script><script src="/assets/js/2.1e679d1d.js" defer></script><script src="/assets/js/112.5e0c1c97.js" defer></script>
  </body>
</html>
