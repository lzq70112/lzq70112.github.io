(window.webpackJsonp=window.webpackJsonp||[]).push([[151],{621:function(s,n,a){"use strict";a.r(n);var e=a(20),r=Object(e.a)({},(function(){var s=this,n=s.$createElement,a=s._self._c||n;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("p",[s._v("LNMP案例之基于Nginx+PHP实现WordPress博客站点，要求Nginx+PHP运行在同一个Pod的不同容器，MySQL运行与default的namespace并可以通过service name增删改查数据库")]),s._v(" "),a("p",[s._v("PHP代码通过NFS共享挂载到每个容器的的代码目录中")]),s._v(" "),a("p",[a("a",{attrs:{href:"https://cn.wordpress.org/download/releases/",target:"_blank",rel:"noopener noreferrer"}},[s._v("WordPress下载"),a("OutboundLink")],1)]),s._v(" "),a("h2",{attrs:{id:"_1、-手动构建php镜像"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1、-手动构建php镜像"}},[s._v("#")]),s._v(" 1、 手动构建PHP镜像")]),s._v(" "),a("p",[a("code",[s._v("vim Dockerfile")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('#PHP Base Image\nFROM my.harbor.com/base/centos:base7.7.1908\nMAINTAINER xiongmao\nRUN yum install -y https://mirrors.tuna.tsinghua.edu.cn/remi/enterprise/remi-release-7.rpm && yum install -y php56-php-fpm php56-php-mysql -y\nADD www.conf /opt/remi/php56/root/etc/php-fpm.d/www.conf\nADD run_php.sh /usr/local/bin/run_php.sh\nEXPOSE 9000\n\nCMD ["/usr/local/bin/run_php.sh"]\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br")])]),a("p",[a("a",{attrs:{href:"https://hongwei888.com/pages/ec829d1/",target:"_blank",rel:"noopener noreferrer"}},[s._v("获取并修改配置文件"),a("OutboundLink")],1)]),s._v(" "),a("p",[a("code",[s._v("vim www.conf")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("[global]\n[www]\nuser = nginx\ngroup = nginx\nlisten = 127.0.0.1:9000\npm = dynamic\npm.max_children = 5\npm.start_servers = 2\npm.min_spare_servers = 1\npm.max_spare_servers = 3\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br")])]),a("p",[a("code",[s._v("vim run_php.sh")]),s._v(" #启动脚本")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("#!/bin/bash\n/opt/remi/php56/root/usr/sbin/php-fpm\ntail -f /etc/hosts\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[a("code",[s._v("chmod +x run_php.sh")]),s._v(" #执行权限不然会出错")]),s._v(" "),a("p",[a("code",[s._v("build-command.sh")]),s._v("  #构建文件")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("#!/bin/bash\nTAG=$1\ndocker build -t my.harbor.com/lnmp/wordpress-php:${TAG} .\nsleep 1\ndocker push  my.harbor.com/lnmp/wordpress-php:${TAG}\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("p",[a("code",[s._v("bash build-command.sh v1")])]),s._v(" "),a("h2",{attrs:{id:"_2、准备wordpress-nginx-基础镜像"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2、准备wordpress-nginx-基础镜像"}},[s._v("#")]),s._v(" 2、准备wordpress Nginx 基础镜像")]),s._v(" "),a("p",[a("a",{attrs:{href:"https://hongwei888.com/pages/b5e1553/#_2%E3%80%81nginx-%E5%9F%BA%E7%A1%80%E9%95%9C%E5%83%8F%E5%BB%BA%E8%AE%BE",target:"_blank",rel:"noopener noreferrer"}},[s._v("构建nginx"),a("OutboundLink")],1)]),s._v(" "),a("h2",{attrs:{id:"_3、准备wordpress-php-nginx业务镜像"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3、准备wordpress-php-nginx业务镜像"}},[s._v("#")]),s._v(" 3、准备wordpress PHP+Nginx业务镜像")]),s._v(" "),a("p",[a("code",[s._v("vim Dockerfile")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('FROM  my.harbor.com/webapp/nginx-web:v1\n\nADD nginx.conf  /usr/local/nginx/conf/nginx.conf\nADD run_nginx.sh /usr/local/nginx/sbin/run_nginx.sh\nRUN mkdir -pv /home/nginx/wordpress /usr/local/nginx/tmp/\nRUN chown nginx:nginx /home/nginx/wordpress/ -R\n\nEXPOSE 80 443\nCMD ["/usr/local/nginx/sbin/run_nginx.sh"]\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br")])]),a("p",[a("code",[s._v("vim nginx.conf")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("user nginx nginx;\nworker_processes auto;\n\nevents {\n    worker_connections 1024;\n    # multi_accept on;\n}\nhttp {\n    sendfile on;      \n    keepalive_timeout 65;\n    client_max_body_size 10M;\n    client_body_buffer_size 16K;\n    client_body_temp_path /usr/local/nginx/tmp/ 1 2 2;\n    \n    include \tmime.types;\n    default_type \tapplication/octet-stream;\n    \n    gzip on;\n    \n    server {\n        listen \t\t80;\n        server_name\tlocalhost;\n\n    # Add index.php to the list if you are using PHP\n        index index.html index.htm index.nginx-debian.html;\n        location / {\n            root \t/home/nginx/wordpress;\n            index\tindex.php index.html index.htm;\n        }\n    # pass PHP scripts to FastCGI server\n    #\n        location ~ \\.php$ {\n            root \t/home/nginx/wordpress;\n            fastcgi_index\tindex.php;\n            fastcgi_pass 127.0.0.1:9000;\n            fastcgi_param\tSCRIPT_FILENAME\t$document_root$fastcgi_script_name;\n            include \tfastcgi_params;\n\n        }\n       \n        error_page\t500 502 503 504 /50x.html;\n        location = /50x.html {\n            root\thtml;\t\n        }\n   \n    }\n}\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br")])]),a("p",[a("code",[s._v("vim run_nginx.sh")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("#!/bin/bash\n/usr/local/nginx/sbin/nginx\ntail -f /etc/hosts\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[a("code",[s._v("vim build-command.sh")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("#!/bin/bash\nTAG=$1\ndocker build -t my.harbor.com/lnmp/wordpress-nginx:${TAG} .\nsleep 1\ndocker push  my.harbor.com/lnmp/wordpress-nginx:${TAG}\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("p",[a("code",[s._v("chmod +x run_nginx.sh")])]),s._v(" "),a("p",[a("code",[s._v("bash build-command.sh v1")])]),s._v(" "),a("hr"),s._v(" "),a("h2",{attrs:{id:"_4、运行wordpress站点"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4、运行wordpress站点"}},[s._v("#")]),s._v(" 4、运行WordPress站点")]),s._v(" "),a("p",[a("code",[s._v("vim wordpress.yaml")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("kind: Deployment\napiVersion: apps/v1\nmetadata:\n  labels:\n    app: wordpress-app \n  name: wordpress-app-deployment\n  namespace: lnmp\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: wordpress-app\n  template:\n    metadata:\n      labels:\n        app: wordpress-app\n    spec:\n      containers:\n      - name: wordpress-app-nginx\n        image: my.harbor.com/lnmp/wordpress-nginx:v1\n        #imagePullPolicy: IfNotPresent\n        imagePullPolicy: Always\n        ports:\n        - containerPort: 80\n          protocol: TCP\n          name: http\n        - containerPort: 443\n          protocol: TCP\n          name: https\n        volumeMounts:\n          - name: wordpress\n            mountPath: /home/nginx/wordpress\n            readOnly: false\n\n      - name: wordpress-app-php\n        image: my.harbor.com/lnmp/wordpress-php:v1\n        #imagePullPolicy: IfNotPresent\n        imagePullPolicy: Always\n        ports:\n        - containerPort: 9000\n          protocol: TCP\n          name: http\n        volumeMounts:\n          - name: wordpress\n            mountPath: /home/nginx/wordpress\n            readOnly: false\n      volumes:\n      - name: wordpress\n        nfs:\n          server: my.nfs.com\n          path: /data/wordpress\n---\nkind: Service\napiVersion: v1\nmetadata:\n  labels:\n    app: wordpress-app\n  name: wordpress-app-spec\n  namespace: lnmp\nspec:\n  type: NodePort\n  ports:\n  - name: http\n    port: 80\n    protocol: TCP\n    targetPort: 80\n    nodePort: 20031\n  - name: https\n    port: 443\n    protocol: TCP\n    targetPort: 443\n    nodePort: 20443\n  selector:\n    app: wordpress-app\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br"),a("span",{staticClass:"line-number"},[s._v("48")]),a("br"),a("span",{staticClass:"line-number"},[s._v("49")]),a("br"),a("span",{staticClass:"line-number"},[s._v("50")]),a("br"),a("span",{staticClass:"line-number"},[s._v("51")]),a("br"),a("span",{staticClass:"line-number"},[s._v("52")]),a("br"),a("span",{staticClass:"line-number"},[s._v("53")]),a("br"),a("span",{staticClass:"line-number"},[s._v("54")]),a("br"),a("span",{staticClass:"line-number"},[s._v("55")]),a("br"),a("span",{staticClass:"line-number"},[s._v("56")]),a("br"),a("span",{staticClass:"line-number"},[s._v("57")]),a("br"),a("span",{staticClass:"line-number"},[s._v("58")]),a("br"),a("span",{staticClass:"line-number"},[s._v("59")]),a("br"),a("span",{staticClass:"line-number"},[s._v("60")]),a("br"),a("span",{staticClass:"line-number"},[s._v("61")]),a("br"),a("span",{staticClass:"line-number"},[s._v("62")]),a("br"),a("span",{staticClass:"line-number"},[s._v("63")]),a("br"),a("span",{staticClass:"line-number"},[s._v("64")]),a("br"),a("span",{staticClass:"line-number"},[s._v("65")]),a("br"),a("span",{staticClass:"line-number"},[s._v("66")]),a("br"),a("span",{staticClass:"line-number"},[s._v("67")]),a("br"),a("span",{staticClass:"line-number"},[s._v("68")]),a("br"),a("span",{staticClass:"line-number"},[s._v("69")]),a("br"),a("span",{staticClass:"line-number"},[s._v("70")]),a("br"),a("span",{staticClass:"line-number"},[s._v("71")]),a("br"),a("span",{staticClass:"line-number"},[s._v("72")]),a("br"),a("span",{staticClass:"line-number"},[s._v("73")]),a("br"),a("span",{staticClass:"line-number"},[s._v("74")]),a("br")])]),a("p",[s._v("测试nginx+php的调用")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/lzq70112/images/blog/image-20210914110014774.png",alt:"image-20210914110014774"}})]),s._v(" "),a("p",[a("code",[s._v("root@nfs:/data/wordpress# ll")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("total 11740\ndrwxr-xr-x  5 root root     4096 Sep 14 11:05 ./\ndrwxr-xr-x 15 root root     4096 Sep 12 23:26 ../\n-rw-r--r--  1 1006 1006      420 Dec  1  2017 index.php\n-rw-r--r--  1 1006 1006    19935 Dec 13  2019 license.txt\n-rw-r--r--  1 1006 1006     7005 Dec 13  2019 readme.html\n-rw-r--r--  1 root root 11807970 Dec 13  2019 wordpress-5.2.5-zh_CN.tar.gz\n-rw-r--r--  1 1006 1006     6919 Jan 12  2019 wp-activate.php\ndrwxr-xr-x  9 1006 1006     4096 Dec 13  2019 wp-admin/\n-rw-r--r--  1 1006 1006      369 Dec  1  2017 wp-blog-header.php\n-rw-r--r--  1 1006 1006     2283 Jan 21  2019 wp-comments-post.php\n-rw-r--r--  1 1006 1006     2776 Dec 13  2019 wp-config-sample.php\ndrwxr-xr-x  5 1006 1006     4096 Dec 13  2019 wp-content/\n-rw-r--r--  1 1006 1006     3847 Jan  9  2019 wp-cron.php\ndrwxr-xr-x 20 1006 1006    12288 Dec 13  2019 wp-includes/\n-rw-r--r--  1 1006 1006     2502 Jan 16  2019 wp-links-opml.php\n-rw-r--r--  1 1006 1006     3306 Dec  1  2017 wp-load.php\n-rw-r--r--  1 1006 1006    39551 Jun 10  2019 wp-login.php\n-rw-r--r--  1 1006 1006     8403 Dec  1  2017 wp-mail.php\n-rw-r--r--  1 1006 1006    18962 Mar 29  2019 wp-settings.php\n-rw-r--r--  1 1006 1006    31085 Jan 17  2019 wp-signup.php\n-rw-r--r--  1 1006 1006     4764 Dec  1  2017 wp-trackback.php\n-rw-r--r--  1 1006 1006     3068 Aug 17  2018 xmlrpc.php\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br")])]),a("p",[a("code",[s._v("chown -R 2020:2020 .")]),s._v(" #修改当前文件为pod nignx用户的uid和gid")]),s._v(" "),a("p",[a("strong",[s._v("测试")])]),s._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/lzq70112/images/blog/image-20210914110833638.png",alt:"image-20210914110833638"}})]),s._v(" "),a("h2",{attrs:{id:"_5、调用mysql容器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5、调用mysql容器"}},[s._v("#")]),s._v(" 5、调用MySQL容器")]),s._v(" "),a("blockquote",[a("p",[a("a",{attrs:{href:"https://hongwei888.com/pages/b5e1560/#_2%E3%80%81%E5%87%86%E5%A4%87xtrabackup%E9%95%9C%E5%83%8F",target:"_blank",rel:"noopener noreferrer"}},[s._v("制作mysql容器"),a("OutboundLink")],1)])]),s._v(" "),a("p",[a("code",[s._v("kubectl exec -it mysql-0 bash")])]),s._v(" "),a("p",[s._v("进入容器创建表单")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("root@mysql-0:/# mysql\nWelcome to the MySQL monitor.  Commands end with ; or \\g.\nYour MySQL connection id is 1182\nServer version: 5.7.35-log MySQL Community Server (GPL)\n\nCopyright (c) 2000, 2021, Oracle and/or its affiliates.\n\nOracle is a registered trademark of Oracle Corporation and/or its\naffiliates. Other names may be trademarks of their respective\nowners.\n\nType 'help;' or '\\h' for help. Type '\\c' to clear the current input statement.\n\nmysql> CREATE DATABASE wordpress;\nQuery OK, 1 row affected (0.01 sec)\n\nmysql> GRANT ALL PRIVILEGES ON wordpress.* TO \"wordpress\"@\"%\" IDENTIFIED BY \"wordpress\";\nQuery OK, 0 rows affected, 1 warning (0.00 sec)\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br")])]),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/lzq70112/images/blog/image-20210914111924304.png",alt:"image-20210914111924304"}})]),s._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/lzq70112/images/blog/image-20210914121220710.png",alt:"image-20210914121220710"}})]),s._v(" "),a("p",[a("code",[s._v("kubectl exec -it mysql-1 bash")]),s._v(" #进入从库查看同步")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("root@mysql-1:/# mysql\nWelcome to the MySQL monitor.  Commands end with ; or \\g.\nYour MySQL connection id is 3236\nServer version: 5.7.35 MySQL Community Server (GPL)\n\nCopyright (c) 2000, 2021, Oracle and/or its affiliates.\n\nOracle is a registered trademark of Oracle Corporation and/or its\naffiliates. Other names may be trademarks of their respective\nowners.\n\nType 'help;' or '\\h' for help. Type '\\c' to clear the current input statement.\n\nmysql> show databases;\n+------------------------+\n| Database               |\n+------------------------+\n| information_schema     |\n| mysql                  |\n| performance_schema     |\n| sys                    |\n| wordpress              |\n| xiongmao               |\n| xtrabackup_backupfiles |\n+------------------------+\n7 rows in set (0.06 sec)\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br")])])])}),[],!1,null,null,null);n.default=r.exports}}]);