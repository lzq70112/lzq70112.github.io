(window.webpackJsonp=window.webpackJsonp||[]).push([[244],{714:function(s,a,t){"use strict";t.r(a);var n=t(20),e=Object(n.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("p",[s._v("前置："),t("RouterLink",{attrs:{to:"/pages/b5e1429/"}},[s._v("master节点安装")])],1),s._v(" "),t("p",[s._v("jenkins之ldap认证\n")]),s._v(" "),t("h2",{attrs:{id:"_1、ldap的安装"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1、ldap的安装"}},[s._v("#")]),s._v(" 1、ldap的安装")]),s._v(" "),t("h3",{attrs:{id:"_1-1、ldap服务和客户端"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-1、ldap服务和客户端"}},[s._v("#")]),s._v(" 1.1、ldap服务和客户端")]),s._v(" "),t("p",[t("code",[s._v("apt-get install -y slapd ldap-utils")])]),s._v(" "),t("p",[s._v("设置管理员密码")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/lzq70112/images/blog/image-20211016164659047.png",alt:"image-20211016164659047"}})]),s._v(" "),t("p",[t("code",[s._v("dpkg-reconfigure slapd")]),s._v(" #初始化")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/lzq70112/images/blog/image-20211016204819315.png",alt:"image-20211016204819315"}})]),s._v(" "),t("p",[s._v("域名设置")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/lzq70112/images/blog/image-20211016221644420.png",alt:"image-20211016221644420"}})]),s._v(" "),t("p",[s._v("组织名称")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/lzq70112/images/blog/image-20211016221700612.png",alt:"image-20211016221700612"}})]),s._v(" "),t("p",[s._v("输入LDAP管理员的密码")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/lzq70112/images/blog/image-20211016205045682.png",alt:"image-20211016205045682"}})]),s._v(" "),t("p",[s._v("再次输入密码")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/lzq70112/images/blog/image-20211016205159748.png",alt:"image-20211016205159748"}})]),s._v(" "),t("p",[s._v("提示信息")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/lzq70112/images/blog/image-20211016205327331.png",alt:"image-20211016205327331"}})]),s._v(" "),t("p",[s._v("学者hdb数据库")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/lzq70112/images/blog/image-20211016205444338.png",alt:"image-20211016205444338"}})]),s._v(" "),t("p",[s._v("删除时，删除数据库")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/lzq70112/images/blog/image-20211016205521186.png",alt:"image-20211016205521186"}})]),s._v(" "),t("p",[s._v("删除旧的数据库")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/lzq70112/images/blog/image-20211016221729620.png",alt:"image-20211016221729620"}})]),s._v(" "),t("p",[s._v("开启LDAPV2")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/lzq70112/images/blog/image-20211016205642867.png",alt:"image-20211016205642867"}})]),s._v(" "),t("p",[t("code",[s._v("ls /var/lib/ldap/")]),s._v(" #数据文件")]),s._v(" "),t("p",[t("code",[s._v("ls /etc/ldap/")]),s._v(" # 配置文件")]),s._v(" "),t("p",[t("code",[s._v("vim add_content.ldif")]),s._v(" 创建数据文件")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("dn: "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ou")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("People,dc"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("ldap,dc"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("com\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 上面初始化创建的ldap.com")]),s._v("\nobjectClass: organizationalUnit\nou: People\n\ndn: "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ou")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("Groups,dc"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("ldap,dc"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("com\nobjectClass: organizationalUnit\nou: Groups\n\ndn: "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("cn")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("miners,ou"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("Groups,dc"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("ldap,dc"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("com\nobjectClass: posixGroup\ncn: miners\ngidNumber: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5000")]),s._v("\n\ndn: "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("uid")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("john,ou"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("People,dc"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("ldap,dc"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("com\nobjectClass: inetOrgPerson\nobjectClass: posixAccount\nobjectClass: shadowAccount\nuid: john\nsn: Doe\ngivenName: John\ncn: John Doe\ndisplayName: John Doe\nuidNumber: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10000")]),s._v("\ngidNumber: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5000")]),s._v("\nuserPassword: johnldap\ngecos: John Doe\nloginShell: /bin/bash\nhomeDirectory: /home/john\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br")])]),t("p",[t("code",[s._v('ldapadd -x -W -D "cn=admin,dc=ldap,dc=com" -f add_content.ldif')]),s._v(" #添加用户指定数据文件")]),s._v(" "),t("p",[t("code",[s._v("slaptest -u")]),s._v(" #测试启动文件")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("systemctl start slapd.service \nsystemctl "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("enable")]),s._v(" slapd.service\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("ls")]),s._v(" /etc/ldap/schema/*.ldif "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("xargs")]),s._v(" -I "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" ldapadd -Y EXTERNAL -H ldapi:/// -f "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#导入模板")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("h3",{attrs:{id:"_1-2、安装httpd"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-2、安装httpd"}},[s._v("#")]),s._v(" 1.2、安装httpd")]),s._v(" "),t("p",[t("code",[s._v("apt install apache2 -y")])]),s._v(" "),t("h3",{attrs:{id:"_1-3、安装phpaldapdmin"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-3、安装phpaldapdmin"}},[s._v("#")]),s._v(" 1.3、安装phpaldapdmin")]),s._v(" "),t("p",[t("code",[s._v("apt install phpldapadmin -y")])]),s._v(" "),t("p",[t("code",[s._v("vim /etc/phpldapadmin/config.php")])]),s._v(" "),t("div",{staticClass:"language-php line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-php"}},[t("code",[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$servers")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("setValue")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[s._v("'server'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[s._v("'name'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[s._v("'Example LDAP'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//该行是您的LDAP服务器的显示名称，Web界面用于有关服务器的标题和消息")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$servers")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("setValue")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[s._v("'server'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[s._v("'base'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("array")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[s._v("'dc=example,dc=com'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//修改为：")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$servers")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("setValue")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[s._v("'server'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[s._v("'base'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("array")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[s._v("'dc=ldap,dc=com'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$config")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),t("span",{pre:!0,attrs:{class:"token property"}},[s._v("custom")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),t("span",{pre:!0,attrs:{class:"token property"}},[s._v("appearance")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[s._v("'hide_template_warning'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token constant boolean"}},[s._v("true")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//取消注释，false改为true，取消模板警告信息")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br")])]),t("h3",{attrs:{id:"_1-4、测试"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-4、测试"}},[s._v("#")]),s._v(" 1.4、测试")]),s._v(" "),t("p",[s._v("http://192.168.2.221/phpldapadmin")]),s._v(" "),t("p",[s._v("账号 cn=admin,dc=ldap,dc=com")]),s._v(" "),t("p",[s._v("密码 123")]),s._v(" "),t("h2",{attrs:{id:"_2、ldap创建ou、cn"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2、ldap创建ou、cn"}},[s._v("#")]),s._v(" 2、ldap创建OU、CN")]),s._v(" "),t("p",[s._v("创建ou")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/lzq70112/images/blog/image-20211016225057288.png",alt:"image-20211016225057288"}})]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/lzq70112/images/blog/image-20211016225203845.png",alt:"image-20211016225203845"}})]),s._v(" "),t("p",[t("strong",[s._v("ou=jenkins,dc=ldap,dc=com")])]),s._v(" "),t("p",[s._v("创建人员")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/lzq70112/images/blog/image-20211016225709721.png",alt:"image-20211016225709721"}})]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/lzq70112/images/blog/image-20211016225825478.png",alt:"image-20211016225825478"}})]),s._v(" "),t("p",[s._v("选择CN")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/lzq70112/images/blog/image-20211016230352842.png",alt:"image-20211016230352842"}})]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/lzq70112/images/blog/image-20211016230309366.png",alt:"image-20211016230309366"}})]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/lzq70112/images/blog/image-20211016230430692.png",alt:"image-20211016230430692"}})]),s._v(" "),t("h2",{attrs:{id:"_3、jenkins集成设置"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3、jenkins集成设置"}},[s._v("#")]),s._v(" 3、jenkins集成设置")]),s._v(" "),t("p",[s._v("修改存储策略")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/lzq70112/images/blog/image-20211016224225441.png",alt:"image-20211016224225441"}})]),s._v(" "),t("p",[s._v("ldap集成")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/lzq70112/images/blog/image-20211016232014421.png",alt:"image-20211016232014421"}})]),s._v(" "),t("h2",{attrs:{id:"_4、测试"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4、测试"}},[s._v("#")]),s._v(" 4、测试")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/lzq70112/images/blog/image-20211016232125657.png",alt:"image-20211016232125657"}})])])}),[],!1,null,null,null);a.default=e.exports}}]);