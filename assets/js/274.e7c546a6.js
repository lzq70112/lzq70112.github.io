(window.webpackJsonp=window.webpackJsonp||[]).push([[274],{744:function(s,a,t){"use strict";t.r(a);var e=t(20),n=Object(e.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h2",{attrs:{id:"_1、linux工具之jq"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1、linux工具之jq"}},[s._v("#")]),s._v(" 1、linux工具之jq")]),s._v(" "),t("p",[s._v("后端开发的工程师经常在linux下开发，当我们拿到一个json格式的数据时，如何有效对这个数据进行分析？我们可以采用"),t("a",{attrs:{href:"https://so.csdn.net/so/search?from=pc_blog_highlight&q=python",target:"_blank",rel:"noopener noreferrer"}},[s._v("python"),t("OutboundLink")],1),s._v("结合json库来分析，但是"),t("a",{attrs:{href:"https://so.csdn.net/so/search?from=pc_blog_highlight&q=linux",target:"_blank",rel:"noopener noreferrer"}},[s._v("linux"),t("OutboundLink")],1),s._v("有一个很好用的工具，让我们可以方便地处理json文本，功能非常强大。")]),s._v(" "),t("p",[t("a",{attrs:{href:"https://alingse.github.io/jq-manual-cn/manual/v1.5/",target:"_blank",rel:"noopener noreferrer"}},[s._v("官方文档"),t("OutboundLink")],1)]),s._v(" "),t("h2",{attrs:{id:"_2、数据准备"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2、数据准备"}},[s._v("#")]),s._v(" 2、数据准备")]),s._v(" "),t("p",[s._v("jq可以把json的文本输出为可读形式，我准备了一份测试json数据，如下：")]),s._v(" "),t("div",{staticClass:"language-json line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-json"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"name"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"xueyuan"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"age"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("21")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"birthday"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"10th August"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"email"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"im.hexueyuan@outlook.com"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"skills"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"C/C++"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Python"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Golang"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Node.js"')]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br")])]),t("h2",{attrs:{id:"_3、使用"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3、使用"}},[s._v("#")]),s._v(" 3、使用")]),s._v(" "),t("p",[s._v("要转换成python处理前的那一种易读形式很简单，执行：")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" json2.data "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" jq "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'.'")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#也可以写作 cat json2.data | jq .")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#不加引号，但是为了标准最好写上，因为某些时候不加会有问题.")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("p",[s._v("jq把数据转换成易读格式，还添加了颜色高亮说明，其中key和value使用了不同的颜色。")]),s._v(" "),t("h2",{attrs:{id:"_4、用法详解"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4、用法详解"}},[s._v("#")]),s._v(" 4、用法详解")]),s._v(" "),t("h3",{attrs:{id:"_4-1、检查是否为json"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-1、检查是否为json"}},[s._v("#")]),s._v(" 4.1、检查是否为json")]),s._v(" "),t("p",[s._v("上一节是"),t("code",[s._v("jq")]),s._v("的常用用法，这里讲解jq的具体原理。")]),s._v(" "),t("p",[s._v("jq从linux管道或者文件中获取文本输入，如果文本不满足json格式，那么jq会报错，可以用这个方法来检查一个文本是否满足json检查：")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("jq "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'.'")]),s._v(" json_file "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" /dev/null\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("jq使用filter来处理json文本，并输出filter处理后的内容到标准输出，filter是用来过滤满足需求的字段的，比如最简单的filter "),t("code",[s._v("'.'")]),s._v("，这个表示无过滤策略，因此会输出全部json文本。")]),s._v(" "),t("h3",{attrs:{id:"_4-2、key-filter"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-2、key-filter"}},[s._v("#")]),s._v(" 4.2、key filter")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("'.<key>'\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("过滤满足key的字段名，输出这个key的值。")]),s._v(" "),t("p",[s._v("如果json数据很大，我们只想看其中某个字段数据，那么使用如下语法:")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#key是字段名称")]),s._v("\njq "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'.<key>'")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[t("code",[s._v("测试")]),s._v(" "),t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/lzq70112/images/blog/202206081322668.png",alt:"image-20220608132223231"}})]),s._v(" "),t("h3",{attrs:{id:"_4-3、key-value-filter"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-3、key-value-filter"}},[s._v("#")]),s._v(" 4.3、key-value filter")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("'<key>'\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("输出key和value，区别key filter，如下\n"),t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/lzq70112/images/blog/202206081329421.png",alt:"image-20220608132909604"}}),s._v("\n因为key-value必须归属于某个对象，所以添加外层{}。")]),s._v(" "),t("h3",{attrs:{id:"_4-4、index-filter"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-4、index-filter"}},[s._v("#")]),s._v(" 4.4、index filter")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("'.<list-key>[index]'\n'.<list-key>[index1, index2]'\n'.<list-key>[s:e]'\n'.<list-key>[:e]'\n'.<list-key>[s:]'\n'.<list-key>[]'\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("p",[s._v("数组索引和切片，用来操作列表元素。")]),s._v(" "),t("p",[s._v("当某个字段是一个列表，jq可以对其进行切片")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("jq "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'.<list-key>[s:e]'")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[t("code",[s._v("测试")]),s._v(" "),t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/lzq70112/images/blog/202206081326504.png",alt:"image-20220608132607154"}})]),s._v(" "),t("p",[s._v("区别一下’.skills’和’.skills[]'两种，可以看到前者输出是一个列表，后者是非json格式的列表成员。")]),s._v(" "),t("h3",{attrs:{id:"_4-5、嵌套层级filter"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-5、嵌套层级filter"}},[s._v("#")]),s._v(" 4.5、嵌套层级filter")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'.key1.key2.key3'")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("用于嵌套的json数据filter。")]),s._v(" "),t("h3",{attrs:{id:"_4-6、多个filter"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-6、多个filter"}},[s._v("#")]),s._v(" 4.6、多个filter")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'.key1, .key2, .key3'")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("使用英文单字节逗号分隔filter，用于在一个filter中过滤多个字段。")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" json2.data "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" jq "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'.age,.name'")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h3",{attrs:{id:"_4-7、filter管道"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-7、filter管道"}},[s._v("#")]),s._v(" 4.7、filter管道")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("'filter1 | filter2 | filter3'\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("jq "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'.contact | .phone | .home'")]),s._v(" people.json\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("由于大部分filter之后，输出仍然是一个json数据，所以可以将filter通过管道连接。")]),s._v(" "),t("h3",{attrs:{id:"_4-8、重新组织filter后输出的数据"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-8、重新组织filter后输出的数据"}},[s._v("#")]),s._v(" 4.8、重新组织filter后输出的数据")]),s._v(" "),t("p",[s._v("有时候我们需要重新构造json的结构，比如去掉某一层嵌套，比如取某几个字段组成一个新的json，这时候我们需要重新改变json的结构，我们可以使用"),t("code",[s._v("[]")]),s._v("和"),t("code",[s._v("{}")]),s._v("来重新组织json。")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#把输出组织成一个列表")]),s._v("\njq "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'[filter1, filter2, filter3]'")]),s._v(" data.json\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[t("code",[s._v("测试")]),s._v(" "),t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/lzq70112/images/blog/202206081336127.png",alt:"image-20220608133646776"}})]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#把输出组织为新的json对象")]),s._v("\njq "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'{filter1, filter2, filter3}'")]),s._v(" data.json\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[t("code",[s._v("测试")])]),s._v(" "),t("p",[s._v("遍历")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/lzq70112/images/blog/202206081338332.png",alt:"在这里插入图片描述"}})]),s._v(" "),t("p",[s._v("切割")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/lzq70112/images/blog/202206081339906.png",alt:"image-20220608133925237"}})]),s._v(" "),t("h3",{attrs:{id:"_4-9、递归展开json结构"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-9、递归展开json结构"}},[s._v("#")]),s._v(" 4.9、递归展开json结构")]),s._v(" "),t("p",[s._v("有时候我们需要在一个json里边查找某个字段，但是确不知道这个字段在哪个嵌套里边，如果嵌套很深那么很难找到，jq可以把嵌套展开打平之后再查找。")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#展开嵌套")]),s._v("\njq "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'..'")]),s._v(" data.json\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[t("code",[s._v("测试")]),s._v(" "),t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/lzq70112/images/blog/202206081342449.png",alt:"image-20220608134208119"}}),s._v("\n展开之后结合管道再次filter可以查找key。")]),s._v(" "),t("h3",{attrs:{id:"_4-10、length-filter"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-10、length-filter"}},[s._v("#")]),s._v(" 4.10、length filter")]),s._v(" "),t("p",[s._v("计算元素长度，对于对象，length表示对象里的元素个数，对于string，length表示string字符数，对于列表，表示列表元素个数。")]),s._v(" "),t("p",[t("code",[s._v("测试")]),s._v(" "),t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/lzq70112/images/blog/202206081348271.png",alt:"image-20220608134803842"}})]),s._v(" "),t("h3",{attrs:{id:"_4-11、keys-filter"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-11、keys-filter"}},[s._v("#")]),s._v(" 4.11、keys filter")]),s._v(" "),t("p",[s._v("输出全部的key，列表形式\n"),t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/lzq70112/images/blog/202206081348305.png",alt:"image-20220608134848020"}})]),s._v(" "),t("h3",{attrs:{id:"_4-12、检查某个key是否存在"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-12、检查某个key是否存在"}},[s._v("#")]),s._v(" 4.12、检查某个key是否存在")]),s._v(" "),t("p",[s._v('如果输入是一个对象，那么对象的元素是以"key-value"形式存在的，使用')]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("jq "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'has(\"key-name\")'")]),s._v(" data.json\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("检查json对象是否含有某个key。")]),s._v(" "),t("h3",{attrs:{id:"_4-13、列表遍历"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-13、列表遍历"}},[s._v("#")]),s._v(" 4.13、列表遍历")]),s._v(" "),t("p",[s._v("jq支持使用map()或者map_values()遍历列表，或者对象的值。")]),s._v(" "),t("p",[t("code",[s._v("测试")]),s._v(" "),t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/lzq70112/images/blog/202206081354040.png",alt:"image-20220608135446435"}})]),s._v(" "),t("h3",{attrs:{id:"_4-14、删除某个key"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-14、删除某个key"}},[s._v("#")]),s._v(" 4.14、删除某个key")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("jq "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'del(filter)'")]),s._v(" json.data\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("使用del()删除filter描述的key-value。")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/lzq70112/images/blog/202206081353753.png",alt:"image-20220608135313182"}})]),s._v(" "),t("h3",{attrs:{id:"_4-15、修改某个key"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-15、修改某个key"}},[s._v("#")]),s._v(" 4.15、修改某个key")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("kubectl get  "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("pv")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$pv")]),s._v(" -o json "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("jq   "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'del(.metadata.annotations)| del(.status)|del(.spec.claimRef)|del(.metadata.resourceVersion)|del(.metadata.uid)|del(.metadata.creationTimestamp)|del(.metadata.finalizers)|del(.metadata.selfLink)'")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("jq  "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'.spec.nodeAffinity.required.nodeSelectorTerms[].matchExpressions[].values[] =123'")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#脚本中应用")]),s._v("\nkubectl get  "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("pv")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$pv")]),s._v(" -o json "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("jq   "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'del(.metadata.annotations)| del(.status)|del(.spec.claimRef)|del(.metadata.resourceVersion)|del(.metadata.uid)|del(.metadata.creationTimestamp)|del(.metadata.finalizers)|del(.metadata.selfLink)'")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("jq --arg "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("v")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$2")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'.spec.nodeAffinity.required.nodeSelectorTerms[].matchExpressions[].values[] =$v'")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("h2",{attrs:{id:"_5、函数"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5、函数"}},[s._v("#")]),s._v(" 5、函数")]),s._v(" "),t("h3",{attrs:{id:"_5-1、判断列表"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-1、判断列表"}},[s._v("#")]),s._v(" 5.1、判断列表")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/lzq70112/images/blog/202206081401721.png",alt:"image-20220608140103969"}})]),s._v(" "),t("p",[s._v("实例:")]),s._v(" "),t("p",[s._v("匹配不等于"),t("code",[s._v("172.17.1.51")]),s._v("时的数据")]),s._v(" "),t("div",{staticClass:"language-json line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-json"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"targets"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"172.17.1.199"')]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"labels"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"__meta_netbox_pop"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"st-1742"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"__snmp_module__"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"arista_sw"')]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"targets"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"172.17.1.51"')]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"labels"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"__meta_netbox_pop"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"st-1754"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"__snmp_module__"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"arista_sw"')]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br")])]),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("jq --arg "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("ip")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.17")]),s._v(".1.51 "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'map(select(.targets | contains([$ip]) | not ))'")]),s._v(" input.json \n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("div",{staticClass:"language-json line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-json"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"targets"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"172.17.1.199"')]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"labels"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"__meta_netbox_pop"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"st-1742"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"__snmp_module__"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"arista_sw"')]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br")])]),t("h3",{attrs:{id:"_5-2、jq当项不存在时如何使用空串以代替"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-2、jq当项不存在时如何使用空串以代替"}},[s._v("#")]),s._v(" 5.2、jq当项不存在时如何使⽤空串以代替")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" dp.json "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("jq "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'..'")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("jq -r "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'if .spec == null then \"\" else .spec end'")]),s._v(" \n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])])])}),[],!1,null,null,null);a.default=n.exports}}]);